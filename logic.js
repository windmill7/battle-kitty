Function.prototype.subclass=function(t){var e=Function.prototype.subclass.nonconstructor;e.prototype=t.prototype,this.prototype=new e},Function.prototype.subclass.nonconstructor=function(){};const backgroundImage=new Image;backgroundImage.src="/images/backgroud.png";const oiiaColor="#14ff06";function arrayContains(t,e){for(var i=0;i<t.length;++i)if(t[i]===e)return!0;return!1}function arrayRemove(t,e){for(var i=0;i<t.length;++i)t[i]===e&&t.splice(i,1)}function arrayRandomElement(t){return t[Math.floor(Math.random()*t.length)]}function Point(t,e){this._x=void 0===t?0:t,this._y=void 0===e?0:e}function Rect(t,e,i,n){Point.call(this,t,e),this._w=i||1,this._h=n||1}function Sprite(t){Rect.call(this),this._eventManager=t,this._prevDirection=Sprite.Direction.RIGHT,this._direction=Sprite.Direction.RIGHT,this._normalSpeed=0,this._speed=0,this._destroyed=!1,this._turn=!1,this._zIndex=0,this._pauseListener=new PauseListener(this._eventManager),this._moveFrequency=1,this._moveTimer=0,this._eventManager.fireEvent({name:Sprite.Event.CREATED,sprite:this})}function Tank(t){Sprite.call(this,t),t.addSubscriber(this,[Bullet.Event.DESTROYED,CollisionDetector.Event.COLLISION,CollisionDetector.Event.OUT_OF_BOUNDS,TankStateAppearing.Event.END,TankStateInvincible.Event.END]),this._w=Globals.UNIT_SIZE,this._h=Globals.UNIT_SIZE,this._type=Tank.Type.PLAYER_1,this._state=new TankStateNormal(this),this._player=!0,this._value=0,this._flashing=!1,this._collisionResolvingMoveLimit=10,this._upgradeLevel=0,this._color=new TankColor,this._hitLimit=1,this._hit=0,this._normalSpeed=2,this._bulletSize=10,this._bulletSpeed=Bullet.Speed.NORMAL,this._trackAnimationDuration=2,this._bulletsLimit=1,this._bullets=0,this._bulletType=Bullet.Type.NORMAL,this._turnSmoothSens=Globals.TILE_SIZE-1,this._turnRoundTo=Globals.TILE_SIZE,this._eventManager.fireEvent({name:Tank.Event.CREATED,tank:this})}function Wall(t){Sprite.call(this,t),this._eventManager.addSubscriber(this,[CollisionDetector.Event.COLLISION]),this._hitLeft=!1,this._hitRight=!1,this._hitTop=!1,this._hitBottom=!1,this._w=Globals.TILE_SIZE,this._h=Globals.TILE_SIZE,this._invincibleForNormalBullets=!1}function SpriteContainer(t){this._eventManager=t,t.addSubscriber(this,[Sprite.Event.CREATED,Sprite.Event.DESTROYED]),this._sprites=[]}function CollisionDetector(t,e,i){this._eventManager=t,this._eventManager.addSubscriber(this,[Sprite.Event.MOVED]),this._bounds=e,this._spriteContainer=i}function EventManager(){this._subscribers={}}function SpriteController(t,e){this._eventManager=t,this._eventManager.addSubscriber(this,[Keyboard.Event.KEY_PRESSED,Keyboard.Event.KEY_RELEASED]),this._sprite=e,this._pauseListener=new PauseListener(this._eventManager)}function TankController(t,e){SpriteController.call(this,t,e),this._eventManager.addSubscriber(this,[BaseExplosion.Event.DESTROYED]),this._active=!0}function Keyboard(t){this._eventManager=t,this._events=[],this._listen(),this._keys={}}function BulletFactory(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Tank.Event.SHOOT])}function Bullet(t,e){Sprite.call(this,t),t.addSubscriber(this,[CollisionDetector.Event.OUT_OF_BOUNDS,CollisionDetector.Event.COLLISION]),this._tank=e,this._explode=!0,this._type=Bullet.Type.NORMAL}function Painter(t){this._spriteContainer=t}function Updater(t){this._spriteContainer=t}function BulletExplosionFactory(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Bullet.Event.DESTROYED]),this._explosionSize=Globals.UNIT_SIZE}function Explosion(t){Sprite.call(this,t),this._animation=new Animation}function BulletExplosion(t){Explosion.call(this,t),this._animation=new Animation([1,2,3])}function BrickWall(t){Wall.call(this,t)}function SteelWall(t){Wall.call(this,t),this._invincibleForNormalBullets=!0}function Cursor(t){Sprite.call(this,t),t.addSubscriber(this,[CollisionDetector.Event.OUT_OF_BOUNDS]),this._w=Globals.UNIT_SIZE,this._h=Globals.UNIT_SIZE,this._normalSpeed=Globals.UNIT_SIZE,this._blinkTimer=new BlinkTimer(12),this._moveDelay=20,this._moveTimer=0,this._moved=!1}function BlinkTimer(t){this._duration=t,this._timer=0,this._visible=!0}function CursorController(t,e){SpriteController.call(this,t,e),this._eventManager.addSubscriber(this,[Cursor.Event.MOVED]),this._spacePressed=!1}function Builder(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Cursor.Event.BUILD,Cursor.Event.MOVED]),this._structures=[Builder.Structure.BRICK_WALL_RIGHT,Builder.Structure.BRICK_WALL_BOTTOM,Builder.Structure.BRICK_WALL_LEFT,Builder.Structure.BRICK_WALL_TOP,Builder.Structure.BRICK_WALL_FULL,Builder.Structure.STEEL_WALL_RIGHT,Builder.Structure.STEEL_WALL_BOTTOM,Builder.Structure.STEEL_WALL_LEFT,Builder.Structure.STEEL_WALL_TOP,Builder.Structure.STEEL_WALL_FULL,Builder.Structure.WATER,Builder.Structure.TREES,Builder.Structure.CLEAR],this._structureIndex=0,this._prevStructureIndex=0,this._structure=this._structures[0],this._tileSize=Globals.TILE_SIZE}function StructureManager(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Builder.Event.STRUCTURE_CREATED,Sprite.Event.DESTROYED]),this._sprites=[]}function BrickWallFactory(t){this._eventManager=t}function SteelWallFactory(t){this._eventManager=t}function Base(t){Sprite.call(this,t),this._eventManager.addSubscriber(this,[CollisionDetector.Event.COLLISION]),this._w=Globals.UNIT_SIZE,this._h=Globals.UNIT_SIZE,this._hit=!1}function TankStateAppearing(t){this._tank=t,this._eventManager=this._tank.getEventManager(),this._animation=new Animation([1,2,3,4,3,2,1,2,3,4,3,2,1],3)}function TankStateNormal(t){this._tank=t,this._trackAnimation=new Animation([1,2],this._tank.getTrackAnimationDuration(),!0),this._flashDuration=7,this._flashTimer=0,this._flashed=!0}function TankStateInvincible(t){TankStateNormal.call(this,t),this._eventManager=this._tank.getEventManager(),this._shieldAnimation=new Animation([1,2],2,!0),this._stateDuration=110,this._stateTimer=0}function AITankController(t,e,i){this._tank=t,this._random=e,this._spriteContainer=i,this._eventManager=this._tank.getEventManager(),this._pauseListener=new PauseListener(this._eventManager),this._eventManager.addSubscriber(this,[Tank.Event.DESTROYED,PowerUpHandler.Event.FREEZE,FreezeTimer.Event.UNFREEZE]),this._tank.toNormalSpeed(),this._shootInterval=15,this._shootTimer=0,this._shootProbability=.7,this._directionUpdateInterval=20,this._directionTimer=0,this._directionUpdateProbability=.6,this._eventManager.fireEvent({name:AITankController.Event.CREATED,controller:this}),this._freezed=!1}function Random(){}function AITankControllerFactory(t,e){this._eventManager=t,this._eventManager.addSubscriber(this,[EnemyFactory.Event.ENEMY_CREATED,PowerUpHandler.Event.FREEZE,FreezeTimer.Event.UNFREEZE]),this._freezed=!1,this._spriteContainer=e}function AITankControllerContainer(t){this._eventManager=t,t.addSubscriber(this,[AITankController.Event.CREATED,AITankController.Event.DESTROYED]),this._controllers=[]}function EnemyFactory(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Points.Event.DESTROYED,TankExplosion.Event.DESTROYED]),this._pauseListener=new PauseListener(this._eventManager),this._positions=[],this._position=0,this._flashingTanks=[4,11,18],this._interval=150,this._timer=this._interval,this._enemies=[],this._enemy=0,this._enemyCount=0,this._enemyCountLimit=4}function Animation(t,e,i){this._frames=void 0!==t?t:[],this._frameDuration=void 0!==e?e:1,this._loop=void 0!==i&&i,this._frame=0,this._timer=0,this._completed=!1,this._active=!0}function TankExplosionFactory(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Tank.Event.DESTROYED]),this._explosionSize=2*Globals.UNIT_SIZE}function TankExplosion(t,e){Explosion.call(this,t),this._tank=e,this._animation=new Animation([1,2,3,4,5,3],3)}function PointsFactory(t){this._eventManager=t,this._eventManager.addSubscriber(this,[TankExplosion.Event.DESTROYED,PowerUp.Event.PICK]),this._pointsSize=Globals.UNIT_SIZE}function Points(t){Sprite.call(this,t),this._value=0,this._duration=20,this._timer=0,this._type=Points.Type.TANK}function PlayerTankFactory(t){this._eventManager=t,this._eventManager.addSubscriber(this,[TankExplosion.Event.DESTROYED]),this._appearPosition=new Point(0,0),this._active=!0}function PlayerTankControllerFactory(t){this._eventManager=t,this._eventManager.addSubscriber(this,[PlayerTankFactory.Event.PLAYER_TANK_CREATED])}function PowerUpFactory(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Tank.Event.FLASHING_TANK_DESTROYED]),this._positions=[]}function PowerUp(t){Sprite.call(this,t),this._eventManager.addSubscriber(this,[CollisionDetector.Event.COLLISION,EnemyFactory.Event.ENEMY_CREATED]),this._w=Globals.UNIT_SIZE,this._h=Globals.UNIT_SIZE,this._type=PowerUp.Type.GRENADE,this._blinkTimer=new BlinkTimer(7),this._value=500,this._playerTank=null}function PowerUpHandler(t){this._eventManager=t,t.addSubscriber(this,[PowerUp.Event.PICK]),this._spriteContainer=null}function FreezeTimer(t){this._eventManager=t,this._eventManager.addSubscriber(this,[PowerUpHandler.Event.FREEZE]),this._duration=300,this._timer=0,this._active=!1,this._pauseListener=new PauseListener(this._eventManager)}function BaseWallBuilder(){this._positions=[],this._factory=null,this._spriteContainer=null}function ShovelHandler(t){this._eventManager=t,this._eventManager.addSubscriber(this,[PowerUpHandler.Event.SHOVEL_START]),this._baseWallBuilder=null,this._pauseListener=new PauseListener(this._eventManager),this._duration=300,this._timer=0,this._active=!1}function Pause(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Keyboard.Event.KEY_PRESSED]),this._pause=!1,this._blinkTimer=new BlinkTimer(12),this._active=!0}function PauseListener(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Pause.Event.START,Pause.Event.END]),this._pause=!1}function BaseExplosionFactory(t){this._eventManager=t,this._eventManager.addSubscriber(this,[Base.Event.HIT]),this._explosionSize=2*Globals.UNIT_SIZE}function BaseExplosion(t){Explosion.call(this,t),this._animation=new Animation([1,2,3,4,5,3],3)}function TankColor(){this._colors=[[0,0]],this._hit=0,this._color=0}function SceneManager(t){this._eventManager=t,this._scene=null}function MainMenuScene(t){this._sceneManager=t,this._eventManager=this._sceneManager.getEventManager(),this._eventManager.addSubscriber(this,[Keyboard.Event.KEY_PRESSED]),this._y=Globals.CANVAS_HEIGHT,this._speed=3,this._mainMenu=new MainMenu,this._mainMenu.setItems([new OnePlayerMenuItem(this._sceneManager)]),this._mainMenuController=new MainMenuController(this._eventManager,this._mainMenu),this._mainMenuController.deactivate(),this._cursor=new MainMenuCursor,this._cursorView=new MainMenuCursorView(this._cursor),this._mainMenuView=new MainMenuView(this._mainMenu,this._cursorView)}function MainMenuItem(t){this._sceneManager=t,this._name=""}function OnePlayerMenuItem(t){MainMenuItem.call(this,t),this.setName("  1 PLAYER")}function MainMenu(){this._items=[],this._item=0}function MainMenuController(t,e){this._eventManager=t,this._eventManager.addSubscriber(this,[Keyboard.Event.KEY_PRESSED]),this._menu=e,this._active=!0}function MainMenuCursor(){this._trackAnimation=new Animation([1,2],2,!0),this._visible=!1}function MainMenuCursorView(t){this._cursor=t}function Gamefield(t){Rect.call(this),this._sceneManager=t,this._eventManager=this._sceneManager.getEventManager(),this._x=Globals.UNIT_SIZE,this._y=Globals.TILE_SIZE,this._w=13*Globals.UNIT_SIZE,this._h=13*Globals.UNIT_SIZE,this._spriteContainer=new SpriteContainer(this._eventManager),this._painter=new Painter(this._spriteContainer),this._updater=new Updater(this._spriteContainer);var e=new Rect(this._x,this._y,this._w,this._h);new CollisionDetector(this._eventManager,e,this._spriteContainer)}function Level(t,e,i){Gamefield.call(this,t);var n=this;this._eventManager.addSubscriber(this,[BaseExplosion.Event.DESTROYED,Player.Event.OUT_OF_LIVES,EnemyFactory.Event.LAST_ENEMY_DESTROYED]),this._visible=!1,this._stage=e,new PlayerTankControllerFactory(this._eventManager),this._playerTankFactory=new PlayerTankFactory(this._eventManager),this._playerTankFactory.setAppearPosition(new Point(this._x+4*Globals.UNIT_SIZE,this._y+12*Globals.UNIT_SIZE)),this._playerTankFactory.create(),new BulletFactory(this._eventManager),new BulletExplosionFactory(this._eventManager),new TankExplosionFactory(this._eventManager),new BaseExplosionFactory(this._eventManager),new PointsFactory(this._eventManager),this._freezeTimer=new FreezeTimer(this._eventManager),this._aiControllersContainer=new AITankControllerContainer(this._eventManager),this._aiTankControllerFactory=new AITankControllerFactory(this._eventManager,this._spriteContainer),this._enemyFactory=new EnemyFactory(this._eventManager),this._enemyFactory.setPositions([new Point(this._x+6*Globals.UNIT_SIZE,this._y),new Point(this._x+12*Globals.UNIT_SIZE,this._y),new Point(this._x,this._y)]),this._enemyFactoryView=new EnemyFactoryView(this._enemyFactory),this._createPowerUpFactory();var r=new BaseWallBuilder;r.setWallPositions([new Point(this._x+11*Globals.TILE_SIZE,this._y+25*Globals.TILE_SIZE),new Point(this._x+11*Globals.TILE_SIZE,this._y+24*Globals.TILE_SIZE),new Point(this._x+11*Globals.TILE_SIZE,this._y+23*Globals.TILE_SIZE),new Point(this._x+12*Globals.TILE_SIZE,this._y+23*Globals.TILE_SIZE),new Point(this._x+13*Globals.TILE_SIZE,this._y+23*Globals.TILE_SIZE),new Point(this._x+14*Globals.TILE_SIZE,this._y+23*Globals.TILE_SIZE),new Point(this._x+14*Globals.TILE_SIZE,this._y+24*Globals.TILE_SIZE),new Point(this._x+14*Globals.TILE_SIZE,this._y+25*Globals.TILE_SIZE)]),r.setSpriteContainer(this._spriteContainer),new PowerUpHandler(this._eventManager).setSpriteContainer(this._spriteContainer),this._shovelHandler=new ShovelHandler(this._eventManager),this._shovelHandler.setBaseWallBuilder(r),this._pause=new Pause(this._eventManager),this._player=void 0===i?new Player:i,this._player.setEventManager(this._eventManager),this._livesView=new LivesView(this._player),this._gameOverMessage=new GameOverMessage,this._gameOverScript=new Script,this._gameOverScript.setActive(!1),this._gameOverScript.enqueue(new MoveFn(this._gameOverMessage,"y",213,100,this._gameOverScript)),this._gameOverScript.enqueue(new Delay(this._gameOverScript,50)),this._gameOverScript.enqueue({execute:function(){t.toStageStatisticsScene(e,n._player,!0)}}),this._levelTransitionScript=new Script,this._levelTransitionScript.setActive(!1),this._levelTransitionScript.enqueue(new Delay(this._levelTransitionScript,200)),this._levelTransitionScript.enqueue({execute:function(){t.toStageStatisticsScene(e,n._player,!1)}}),this._loadStage(this._stage)}function EnemyFactoryView(t){this._enemyFactory=t}function LivesView(t){this._player=t}function MainMenuView(t,e){this._menu=t,this._cursorView=e}function Curtain(){this._height=Globals.CANVAS_HEIGHT/2,this._speed=15,this._position=0}function Script(){this._nodes=[],this._active=!0}function Delay(t,e){this._script=t,this._duration=e,this._timer=0}function GameScene(t,e,i){var n=this;this._sceneManager=t,this._curtain=new Curtain,this._stage=void 0===e?1:e,this._stageMessage=new StageMessage(this._stage),this._level=new Level(t,this._stage,i),this._script=new Script,this._script.enqueue({update:function(){n._curtain.fall(),n._curtain.isFallen()&&n._script.actionCompleted()}}),this._script.enqueue({execute:function(){n._stageMessage.show(),SoundManager.play("stage_start")}}),this._script.enqueue(new Delay(this._script,60)),this._script.enqueue({execute:function(){n._stageMessage.hide(),n._level.show()}}),this._script.enqueue({update:function(){n._curtain.rise(),n._curtain.isRisen()&&n._script.actionCompleted()}}),this._script.enqueue(this._level)}function StageMessage(t){this._stage=t,this._visible=!1}function MoveFn(t,e,i,n,r){this._object=t,this._property=e,this._endValue=i,this._duration=n,this._listener=r,this._active=!0,this._increment=(i-this._object[this._property])/n}function GameOverMessage(){this.x=210,this.y=Globals.CANVAS_HEIGHT+16}function StageStatisticsScene(t,e,i,n){var r=this;this._sceneManager=t,this._stage=e,this._player=i,this._gameOver=n,this._script=new Script,this._basicTankPoints=new StageStatisticsPoints(100,this._player.getTanks(Tank.Type.BASIC),this._script),this._fastTankPoints=new StageStatisticsPoints(200,this._player.getTanks(Tank.Type.FAST),this._script),this._powerTankPoints=new StageStatisticsPoints(300,this._player.getTanks(Tank.Type.POWER),this._script),this._armorTankPoints=new StageStatisticsPoints(400,this._player.getTanks(Tank.Type.ARMOR),this._script),this._drawTotal=!1,this._script.enqueue(new Delay(this._script,30)),this._script.enqueue({execute:function(){r._basicTankPoints.show()}}),this._script.enqueue(this._basicTankPoints),this._script.enqueue({execute:function(){r._fastTankPoints.show()}}),this._script.enqueue(this._fastTankPoints),this._script.enqueue({execute:function(){r._powerTankPoints.show()}}),this._script.enqueue(this._powerTankPoints),this._script.enqueue({execute:function(){r._armorTankPoints.show()}}),this._script.enqueue(this._armorTankPoints),this._script.enqueue({execute:function(){r._drawTotal=!0}}),this._script.enqueue(new Delay(this._script,60)),this._script.enqueue({execute:function(){r._player.resetTanks(),n?t.toGameOverScene():t.toGameScene(e+1,i)}})}function GameOverScene(t){this._sceneManager=t,this._script=new Script,this._script.enqueue(new Delay(this._script,10)),this._script.enqueue({execute:function(){SoundManager.play("game_over")}}),this._script.enqueue(new Delay(this._script,100)),this._script.enqueue({execute:function(){t.toMainMenuScene()}})}function Player(){this._lives=2,this._score=0,this.resetTanks()}function StageStatisticsPoints(t,e,i){var n=this;this._value=t,this._count=e,this._counter=e>0?1:0,this._visible=!1,this._listener=i,this._script=new Script,this._script.enqueue(new Delay(this._script,15));for(var r=1;r<this._count;++r)this._script.enqueue({execute:function(){n._counter++,SoundManager.play("statistics_1")}}),this._script.enqueue(new Delay(this._script,10));this._script.enqueue(new Delay(this._script,15)),this._script.enqueue({execute:function(){n._listener.actionCompleted()}})}function Trees(t){Sprite.call(this,t),this._zIndex=1}function Water(t){Sprite.call(this,t),this._animation=new Animation([1,2],30,!0),this._w=Globals.UNIT_SIZE,this._h=Globals.UNIT_SIZE}function LoadingScene(t){this._sceneManager=t,this._loadingProgress=0}Object.size=function(t){var e,i=0;for(e in t)t.hasOwnProperty(e)&&i++;return i},String.prototype.lpad=function(t,e){for(var i=this;i.length<e;)i=t+i;return i},Point.prototype.getX=function(){return this._x},Point.prototype.setX=function(t){this._x=t},Point.prototype.getY=function(){return this._y},Point.prototype.setY=function(t){this._y=t},Point.prototype.getPosition=function(){return new Point(this._x,this._y)},Point.prototype.setPosition=function(t){this._x=t.getX(),this._y=t.getY()},Point.prototype.setXY=function(t,e){this._x=t,this._y=e},Rect.subclass(Point),Rect.prototype.setRect=function(t){this._x=t.getX(),this._y=t.getY(),this._w=t.getWidth(),this._h=t.getHeight()},Rect.prototype.getRect=function(){return new Rect(this._x,this._y,this._w,this._h)},Rect.prototype.setWidth=function(t){this._w=t},Rect.prototype.getWidth=function(){return this._w},Rect.prototype.setHeight=function(t){this._h=t},Rect.prototype.getHeight=function(){return this._h},Rect.prototype.setDimensions=function(t,e){this._w=t,this._h=e},Rect.prototype.getLeft=function(){return this._x},Rect.prototype.getRight=function(){return this._x+this._w-1},Rect.prototype.getTop=function(){return this._y},Rect.prototype.getBottom=function(){return this._y+this._h-1},Rect.prototype.getCenter=function(){return new Point(this._x+this._w/2,this._y+this._h/2)},Rect.prototype.intersects=function(t){return!(this.getLeft()>t.getRight()||this.getRight()<t.getLeft()||this.getTop()>t.getBottom()||this.getBottom()<t.getTop())},Rect.prototype.containsWhole=function(t){return t.getLeft()>=this.getLeft()&&t.getRight()<=this.getRight()&&t.getBottom()<=this.getBottom()&&t.getTop()>=this.getTop()},Sprite.subclass(Rect),Sprite.Direction={RIGHT:"right",LEFT:"left",UP:"up",DOWN:"down"},Sprite.Event={},Sprite.Event.MOVED="Sprite.Event.MOVED",Sprite.Event.CREATED="Sprite.Event.CREATED",Sprite.Event.DESTROYED="Sprite.Event.DESTROYED",Sprite.prototype.getDirection=function(){return this._direction},Sprite.prototype.setDirection=function(t){t!=this._direction&&(this._prevDirection=this._direction,this._direction=t,this._turn=!0)},Sprite.prototype.getPrevDirection=function(){return this._prevDirection},Sprite.prototype.isTurn=function(){return this._turn},Sprite.prototype.getSpeed=function(){return this._speed},Sprite.prototype.setSpeed=function(t){this._speed=t},Sprite.prototype.getNormalSpeed=function(){return this._normalSpeed},Sprite.prototype.setNormalSpeed=function(t){this._normalSpeed=t},Sprite.prototype.toNormalSpeed=function(){this._speed=this._normalSpeed},Sprite.prototype.setMoveFrequency=function(t){this._moveFrequency=t},Sprite.prototype.stop=function(){this._speed=0},Sprite.prototype.move=function(){this._moveTimer++,this._moveTimer<this._moveFrequency||0==this._speed||(this._moveTimer=0,this.doMove())},Sprite.prototype.doMove=function(){this._x=this._getNewX(),this._y=this._getNewY(),this._turn=!1,this._eventManager.fireEvent({name:Sprite.Event.MOVED,sprite:this}),this.moveHook()},Sprite.prototype.moveHook=function(){},Sprite.prototype.update=function(){this._destroyed?this.doDestroy():(this.isPaused()||this.move(),this.updateHook())},Sprite.prototype.updateHook=function(){},Sprite.prototype.destroy=function(){this._destroyed=!0},Sprite.prototype.isDestroyed=function(){return this._destroyed},Sprite.prototype.doDestroy=function(){this._pauseListener.destroy(),this._eventManager.removeSubscriber(this),this._eventManager.fireEvent({name:Sprite.Event.DESTROYED,sprite:this}),this.destroyHook()},Sprite.prototype.destroyHook=function(){},Sprite.prototype.resolveOutOfBounds=function(t){this._direction==Sprite.Direction.RIGHT?this._x=t.getRight()-this._w+1:this._direction==Sprite.Direction.LEFT?this._x=t.getLeft():this._direction==Sprite.Direction.UP?this._y=t.getTop():this._direction==Sprite.Direction.DOWN&&(this._y=t.getBottom()-this._h+1)},Sprite.prototype.setZIndex=function(t){this._zIndex=t},Sprite.prototype.getZIndex=function(){return this._zIndex},Sprite.prototype.isPaused=function(){return this._pauseListener.isPaused()},Sprite.prototype.setPauseListener=function(t){this._pauseListener.destroy(),this._pauseListener=t},Sprite.prototype._getNewX=function(){var t=this._x;return this._direction==Sprite.Direction.RIGHT?t+=this._speed:this._direction==Sprite.Direction.LEFT&&(t-=this._speed),t},Sprite.prototype._getNewY=function(){var t=this._y;return this._direction==Sprite.Direction.UP?t-=this._speed:this._direction==Sprite.Direction.DOWN&&(t+=this._speed),t},Tank.subclass(Sprite),Tank.Type={},Tank.Type.PLAYER_1="player1",Tank.Type.BASIC="basic",Tank.Type.FAST="fast",Tank.Type.POWER="power",Tank.Type.ARMOR="armor",Tank.Event={},Tank.Event.SHOOT="Tank.Event.SHOOT",Tank.Event.CREATED="Tank.Event.CREATED",Tank.Event.DESTROYED="Tank.Event.DESTROYED",Tank.Event.PLAYER_DESTROYED="Tank.Event.PLAYER_DESTROYED",Tank.Event.ENEMY_DESTROYED="Tank.Event.ENEMY_DESTROYED",Tank.Event.FLASHING_TANK_DESTROYED="Tank.Event.FLASHING_TANK_DESTROYED",Tank.prototype.getState=function(){return this._state},Tank.prototype.setValue=function(t){this._value=t},Tank.prototype.getValue=function(){return this._value},Tank.prototype.setState=function(t){this._state=t},Tank.prototype.getType=function(){return this._type},Tank.prototype.setType=function(t){this._type=t},Tank.prototype.isPlayer=function(){return this._player},Tank.prototype.isEnemy=function(){return!this._player},Tank.prototype.makeEnemy=function(){this._player=!1},Tank.prototype.setBulletSize=function(t){this._bulletSize=t},Tank.prototype.getBulletSize=function(){return this._bulletSize},Tank.prototype.setBulletSpeed=function(t){this._bulletSpeed=t},Tank.prototype.getBulletSpeed=function(){return this._bulletSpeed},Tank.prototype.setBulletsLimit=function(t){this._bulletsLimit=t},Tank.prototype.getBulletsLimit=function(){return this._bulletsLimit},Tank.prototype.getBulletType=function(){return this._bulletType},Tank.prototype.setBulletType=function(t){this._bulletType=t},Tank.prototype.shoot=function(){this.isDestroyed()||this._state.canShoot()&&(this._bullets>=this._bulletsLimit||(this._bullets++,this._eventManager.fireEvent({name:Tank.Event.SHOOT,tank:this})))},Tank.prototype.updateHook=function(){this._state.update()},Tank.prototype.updateColor=function(){this.isFlashing()&&0==this._hit||this._color.update()},Tank.prototype.setColor=function(t){this._color=t},Tank.prototype.setColorValues=function(t){this._color.setColors(t)},Tank.prototype.getColorValue=function(){return this._color.getColor()},Tank.prototype.notify=function(t){t.name==Bullet.Event.DESTROYED&&t.tank==this?this._bullets--:this._wallCollision(t)||this._tankCollision(t)||this._baseCollision(t)||this._waterCollision(t)?this.resolveCollisionWithSprite(t.sprite):this._bulletCollision(t)&&this.canBeDestroyed()?this.hit():t.name==CollisionDetector.Event.OUT_OF_BOUNDS&&t.sprite===this?this.resolveOutOfBounds(t.bounds):t.name==TankStateAppearing.Event.END&&t.tank===this?this.stateAppearingEnd():t.name==TankStateInvincible.Event.END&&t.tank===this&&(this._state=new TankStateNormal(this))},Tank.prototype.stateAppearingEnd=function(){this._player?(this._state=new TankStateInvincible(this),this._direction=Sprite.Direction.UP):(this._state=new TankStateNormal(this),this._direction=Sprite.Direction.DOWN)},Tank.prototype.setTurnSmoothSens=function(t){this._turnSmoothSens=t},Tank.prototype.getTurnSmoothSens=function(){return this._turnSmoothSens},Tank.prototype.setTurnRoundTo=function(t){this._turnRoundTo=t},Tank.prototype.getTurnRoundTo=function(){return this._turnRoundTo},Tank.prototype.move=function(){this._state.canMove()&&(this._turn&&this._smoothTurn(),Sprite.prototype.move.call(this))},Tank.prototype.canMove=function(){return this._state.canMove()},Tank.prototype.getEventManager=function(){return this._eventManager},Tank.prototype.hit=function(){this._hit++,this._color.hit(),this._hit==this._hitLimit&&this.destroy()},Tank.prototype.isNotHit=function(){return 0==this._hit},Tank.prototype.setHitLimit=function(t){this._hitLimit=t},Tank.prototype.destroyHook=function(){this._eventManager.fireEvent({name:Tank.Event.DESTROYED,tank:this}),this._player?this._eventManager.fireEvent({name:Tank.Event.PLAYER_DESTROYED,tank:this}):this._eventManager.fireEvent({name:Tank.Event.ENEMY_DESTROYED,tank:this}),this._flashing&&this._eventManager.fireEvent({name:Tank.Event.FLASHING_TANK_DESTROYED,tank:this})},Tank.prototype.canBeDestroyed=function(){return this._state.canBeDestroyed()},Tank.prototype.isCollidable=function(){return this._state.isCollidable()},Tank.prototype.isFlashing=function(){return this._flashing},Tank.prototype.startFlashing=function(){this._flashing=!0},Tank.prototype.getTrackAnimationDuration=function(){return this._trackAnimationDuration},Tank.prototype.setTrackAnimationDuration=function(t){this._trackAnimationDuration=t},Tank.prototype._smoothTurn=function(){var t;this._direction==Sprite.Direction.UP||this._direction==Sprite.Direction.DOWN?this._prevDirection==Sprite.Direction.RIGHT?(t=this._turnRoundTo-this._x%this._turnRoundTo)<this._turnSmoothSens&&(this._x+=t):this._prevDirection==Sprite.Direction.LEFT&&(t=this._x%this._turnRoundTo)<this._turnSmoothSens&&(this._x-=t):this._prevDirection==Sprite.Direction.DOWN?(t=this._turnRoundTo-this._y%this._turnRoundTo)<this._turnSmoothSens&&(this._y+=t):this._prevDirection==Sprite.Direction.UP&&(t=this._y%this._turnRoundTo)<this._turnSmoothSens&&(this._y-=t)},Tank.prototype.draw=function(t){this._state.draw(t)},Tank.prototype.resolveCollisionWithSprite=function(t){var e=0,i=0;this._direction==Sprite.Direction.RIGHT?e=this.getRight()-t.getLeft()+1:this._direction==Sprite.Direction.LEFT?e=this.getLeft()-t.getRight()-1:this._direction==Sprite.Direction.UP?i=this.getTop()-t.getBottom()-1:this._direction==Sprite.Direction.DOWN&&(i=this.getBottom()-t.getTop()+1),Math.abs(e)>this._collisionResolvingMoveLimit||Math.abs(i)>this._collisionResolvingMoveLimit||(this._x-=e,this._y-=i)},Tank.prototype.setCollisionResolvingMoveLimit=function(t){this._collisionResolvingMoveLimit=t},Tank.prototype.upgrade=function(){this._upgradeLevel++,this._upgradeLevel>3?this._upgradeLevel=3:1==this._upgradeLevel?this._bulletSpeed=Bullet.Speed.FAST:2==this._upgradeLevel?this._bulletsLimit=2:3==this._upgradeLevel&&(this._bulletType=Bullet.Type.ENHANCED)},Tank.prototype.getUpgradeLevel=function(){return this._upgradeLevel},Tank.prototype._bulletCollision=function(t){if(t.name!=CollisionDetector.Event.COLLISION)return!1;if(!(t.initiator instanceof Bullet))return!1;if(t.sprite!==this)return!1;var e=t.initiator.getTank();return e!==this&&(!this.isEnemy()||!e.isEnemy())},Tank.prototype._wallCollision=function(t){return t.name==CollisionDetector.Event.COLLISION&&t.initiator===this&&t.sprite instanceof Wall},Tank.prototype._baseCollision=function(t){return t.name==CollisionDetector.Event.COLLISION&&t.initiator===this&&t.sprite instanceof Base},Tank.prototype._waterCollision=function(t){return t.name==CollisionDetector.Event.COLLISION&&t.initiator===this&&t.sprite instanceof Water},Tank.prototype._tankCollision=function(t){return t.name==CollisionDetector.Event.COLLISION&&t.initiator===this&&t.sprite instanceof Tank&&t.sprite.isCollidable()},Wall.subclass(Sprite),Wall.prototype.notify=function(t){t.name==CollisionDetector.Event.COLLISION&&t.initiator instanceof Bullet&&t.sprite===this&&this.hitByBullet(t.initiator)},Wall.prototype.hitByBullet=function(t){t.getType()!=Bullet.Type.ENHANCED?this.isInvincibleForNormalBullets()||(t.getDirection()==Sprite.Direction.RIGHT?this.hitLeft():t.getDirection()==Sprite.Direction.LEFT?this.hitRight():t.getDirection()==Sprite.Direction.DOWN?this.hitTop():t.getDirection()==Sprite.Direction.UP&&this.hitBottom()):this.destroy()},Wall.prototype.hitLeft=function(){this._hitLeft||this._hitRight?this.destroy():this._hitLeft=!0},Wall.prototype.isHitLeft=function(){return this._hitLeft},Wall.prototype.hitRight=function(){this._hitRight||this._hitLeft?this.destroy():this._hitRight=!0},Wall.prototype.isHitRight=function(){return this._hitRight},Wall.prototype.hitTop=function(){this._hitTop||this._hitBottom?this.destroy():this._hitTop=!0},Wall.prototype.isHitTop=function(){return this._hitTop},Wall.prototype.hitBottom=function(){this._hitBottom||this._hitTop?this.destroy():this._hitBottom=!0},Wall.prototype.isHitBottom=function(){return this._hitBottom},Wall.prototype.draw=function(t){t.drawImage(ImageManager.getImage(this.getImage()),this._x,this._y),this._hideDestroyedAreas(t)},Wall.prototype.makeInvincibleForNormalBullets=function(){this._invincibleForNormalBullets=!0},Wall.prototype.isInvincibleForNormalBullets=function(){return this._invincibleForNormalBullets},Wall.prototype._hideDestroyedAreas=function(t){t.fillStyle="#14ff06",this._hitTop&&t.fillRect(this._x,this._y,this._w,this._h/2),this._hitBottom&&t.fillRect(this._x,this._y+this._h/2,this._w,this._h/2),this._hitLeft&&t.fillRect(this._x,this._y,this._w/2,this._h),this._hitRight&&t.fillRect(this._x+this._w/2,this._y,this._w/2,this._h)},SpriteContainer.prototype.addSprite=function(t){this._sprites.push(t),this._sortSpritesByZIndex()},SpriteContainer.prototype.removeSprite=function(t){arrayRemove(this._sprites,t)},SpriteContainer.prototype.containsSprite=function(t){return arrayContains(this._sprites,t)},SpriteContainer.prototype.getSprites=function(){return this._sprites},SpriteContainer.prototype.getEnemyTanks=function(){return this._sprites.filter((function(t){return t instanceof Tank&&t.isEnemy()}))},SpriteContainer.prototype.getWalls=function(){return this._sprites.filter((function(t){return t instanceof Wall}))},SpriteContainer.prototype.getBase=function(){for(var t=0;t<this._sprites.length;++t)if(this._sprites[t]instanceof Base)return this._sprites[t];return null},SpriteContainer.prototype.notify=function(t){t.name==Sprite.Event.CREATED?this.addSprite(t.sprite):t.name==Sprite.Event.DESTROYED&&this.removeSprite(t.sprite)},SpriteContainer.prototype._sortSpritesByZIndex=function(){this._sprites.sort((function(t,e){return t.getZIndex()<e.getZIndex()?-1:t.getZIndex()>e.getZIndex()?1:0}))},CollisionDetector.Event={},CollisionDetector.Event.COLLISION="CollisionDetector.Event.COLLISION",CollisionDetector.Event.OUT_OF_BOUNDS="CollisionDetector.Event.OUT_OF_BOUNDS",CollisionDetector.prototype.notify=function(t){SpriteContainer.prototype.notify.call(this,t),t.name==Sprite.Event.MOVED&&(this._detectCollisionsForSprite(t.sprite),this._detectOutOfBoundsForSprite(t.sprite))},CollisionDetector.prototype._detectCollisionsForSprite=function(t){this._spriteContainer.getSprites().forEach((function(e){t!==e&&t.intersects(e)&&this._eventManager.fireEvent({name:CollisionDetector.Event.COLLISION,initiator:t,sprite:e})}),this)},CollisionDetector.prototype._detectOutOfBoundsForSprite=function(t){this._bounds.containsWhole(t)||this._eventManager.fireEvent({name:CollisionDetector.Event.OUT_OF_BOUNDS,sprite:t,bounds:this._bounds})},EventManager.prototype.addSubscriber=function(t,e){for(var i in e)this._subscribers[e[i]]||(this._subscribers[e[i]]=[]),this._subscribers[e[i]].push(t)},EventManager.prototype.removeSubscriber=function(t){for(var e in this._subscribers)for(var i in this._subscribers[e])this._subscribers[e][i]===t&&this._subscribers[e].splice(i,1)},EventManager.prototype.removeAllSubscribers=function(){this._subscribers={}},EventManager.prototype.fireEvent=function(t){var e=this._subscribers[t.name];for(var i in e)e[i].notify(t)},SpriteController.prototype.notify=function(t){t.name!=Keyboard.Event.KEY_PRESSED||this._pauseListener.isPaused()?t.name==Keyboard.Event.KEY_RELEASED&&this.keyReleased(t.key):this.keyPressed(t.key)},SpriteController.prototype.keyPressed=function(t){t==Keyboard.Key.LEFT?(this._sprite.setDirection(Sprite.Direction.LEFT),this._sprite.toNormalSpeed()):t==Keyboard.Key.RIGHT?(this._sprite.setDirection(Sprite.Direction.RIGHT),this._sprite.toNormalSpeed()):t==Keyboard.Key.UP?(this._sprite.setDirection(Sprite.Direction.UP),this._sprite.toNormalSpeed()):t==Keyboard.Key.DOWN&&(this._sprite.setDirection(Sprite.Direction.DOWN),this._sprite.toNormalSpeed())},SpriteController.prototype.keyReleased=function(t){(this._sprite.getDirection()==Sprite.Direction.LEFT&&t==Keyboard.Key.LEFT||this._sprite.getDirection()==Sprite.Direction.RIGHT&&t==Keyboard.Key.RIGHT||this._sprite.getDirection()==Sprite.Direction.UP&&t==Keyboard.Key.UP||this._sprite.getDirection()==Sprite.Direction.DOWN&&t==Keyboard.Key.DOWN)&&this._sprite.stop()},TankController.subclass(SpriteController),TankController.prototype.notify=function(t){SpriteController.prototype.notify.call(this,t),t.name==BaseExplosion.Event.DESTROYED&&(this._sprite.stop(),this._active=!1)},TankController.prototype.keyPressed=function(t){this._active&&this._sprite.canMove()&&(SpriteController.prototype.keyPressed.call(this,t),t==Keyboard.Key.SPACE&&this._sprite.shoot())},Keyboard.Key={},Keyboard.Key.SPACE=32,Keyboard.Key.LEFT=37,Keyboard.Key.UP=38,Keyboard.Key.RIGHT=39,Keyboard.Key.DOWN=40,Keyboard.Key.S=83,Keyboard.Key.SELECT=17,Keyboard.Key.START=13,Keyboard.Event={},Keyboard.Event.KEY_PRESSED="Keyboard.Event.KEY_PRESSED",Keyboard.Event.KEY_RELEASED="Keyboard.Event.KEY_RELEASED",Keyboard.prototype._listen=function(){var t=this;$(document).keydown((function(e){t._keys[e.which]||(t._keys[e.which]=!0,t._events.push({name:Keyboard.Event.KEY_PRESSED,key:e.which})),e.preventDefault()})),$(document).keyup((function(e){t._keys[e.which]&&(t._keys[e.which]=!1,t._events.push({name:Keyboard.Event.KEY_RELEASED,key:e.which})),e.preventDefault()}))},Keyboard.prototype.fireEvents=function(){this._events.forEach((function(t){this._eventManager.fireEvent(t)}),this),this._events=[]},BulletFactory.prototype.notify=function(t){t.name==Tank.Event.SHOOT&&this.createBullet(t.tank)},BulletFactory.prototype.createBullet=function(t){var e=new Bullet(this._eventManager,t);return e.setPosition(this._getBulletPosition(t)),e.setDimensions(t.getBulletSize(),t.getBulletSize()),e.setDirection(t.getDirection()),e.setSpeed(t.getBulletSpeed()),e.setType(t.getBulletType()),t.isPlayer()&&SoundManager.play("bullet_shot"),e},BulletFactory.prototype._getBulletPosition=function(t){var e,i,n=t.getDirection();return n==Sprite.Direction.RIGHT?(e=t.getRight()-1,i=t.getTop()+t.getHeight()/2-t.getBulletSize()/2):n==Sprite.Direction.LEFT?(e=t.getLeft()+1,i=t.getTop()+t.getHeight()/2-t.getBulletSize()/2):n==Sprite.Direction.UP?(e=t.getLeft()+t.getWidth()/2-t.getBulletSize()/2,i=t.getTop()+1):n==Sprite.Direction.DOWN&&(e=t.getLeft()+t.getWidth()/2-t.getBulletSize()/2,i=t.getBottom()-1),new Point(e,i)},Bullet.subclass(Sprite),Bullet.Event={},Bullet.Event.DESTROYED="Bullet.Event.DESTROYED",Bullet.Speed={},Bullet.Speed.NORMAL=5,Bullet.Speed.FAST=8,Bullet.Type={},Bullet.Type.NORMAL="Bullet.Type.NORMAL",Bullet.Type.ENHANCED="Bullet.Type.ENHANCED",Bullet.prototype.notify=function(t){this._outOfBounds(t)?(this._tank.isPlayer()&&SoundManager.play("bullet_hit_1"),this.destroy()):this._wallCollision(t)?(this._tank.isPlayer()&&(t.sprite instanceof SteelWall?SoundManager.play("bullet_hit_1"):t.sprite instanceof BrickWall&&SoundManager.play("bullet_hit_2")),this.destroy()):this._baseCollision(t)?this.destroy():this._tankCollision(t)&&t.sprite.isCollidable()?(this._explode=t.sprite.canBeDestroyed(),this.destroy()):this._bulletCollision(t)&&(this._explode=!1,this.destroy())},Bullet.prototype.destroyHook=function(){this._eventManager.fireEvent({name:Bullet.Event.DESTROYED,bullet:this,tank:this._tank})},Bullet.prototype.getImage=function(){return"bullet_"+this._direction},Bullet.prototype.draw=function(t){t.drawImage(ImageManager.getImage(this.getImage()),this._x,this._y)},Bullet.prototype.getTank=function(){return this._tank},Bullet.prototype.setExplode=function(t){this._explode=t},Bullet.prototype.shouldExplode=function(){return this._explode},Bullet.prototype.getType=function(){return this._type},Bullet.prototype.setType=function(t){this._type=t},Bullet.prototype._outOfBounds=function(t){return t.name==CollisionDetector.Event.OUT_OF_BOUNDS&&t.sprite===this},Bullet.prototype._wallCollision=function(t){return t.name==CollisionDetector.Event.COLLISION&&(t.initiator===this&&t.sprite instanceof Wall)},Bullet.prototype._baseCollision=function(t){return t.name==CollisionDetector.Event.COLLISION&&(t.initiator===this&&(t.sprite instanceof Base&&!t.sprite.isHit()))},Bullet.prototype._tankCollision=function(t){if(t.name!=CollisionDetector.Event.COLLISION)return!1;if(t.initiator!==this)return!1;if(!(t.sprite instanceof Tank))return!1;var e=t.sprite;return e!==this._tank&&(!e.isEnemy()||!this._tank.isEnemy())},Bullet.prototype._bulletCollision=function(t){if(t.name!=CollisionDetector.Event.COLLISION)return!1;if(!(t.sprite instanceof Bullet&&t.initiator instanceof Bullet))return!1;var e=t.sprite.getTank();return!this._tank.isEnemy()||!e.isEnemy()},Painter.prototype.draw=function(t){this._spriteContainer.getSprites().forEach((function(e){e.draw(t)}))},Updater.prototype.update=function(){this._spriteContainer.getSprites().forEach((function(t){t.update()}))},BulletExplosionFactory.prototype.setExplosionSize=function(t){this._explosionSize=t},BulletExplosionFactory.prototype.getExplosionSize=function(){return this._explosionSize},BulletExplosionFactory.prototype.notify=function(t){t.name==Bullet.Event.DESTROYED&&t.bullet.shouldExplode()&&this.create(t.bullet)},BulletExplosionFactory.prototype.create=function(t){var e=new BulletExplosion(this._eventManager),i=t.getCenter();return e.setRect(new Rect(i.getX()-this._explosionSize/2,i.getY()-this._explosionSize/2,this._explosionSize,this._explosionSize)),e},Explosion.subclass(Sprite),Explosion.prototype.setFrames=function(t){this._animation.setFrames(t)},Explosion.prototype.updateHook=function(){this._pauseListener.isPaused()||(this._animation.isCompleted()?this.destroy():this._animation.update())},Explosion.prototype.draw=function(t){t.drawImage(ImageManager.getImage(this.getImage()),this._x,this._y)},BulletExplosion.subclass(Explosion),BulletExplosion.prototype.getImage=function(){return"bullet_explosion_"+this._animation.getFrame()},BrickWall.subclass(Wall),BrickWall.prototype.getClassName=function(){return"BrickWall"},BrickWall.prototype.getImage=function(){return"wall_brick"},SteelWall.subclass(Wall),SteelWall.prototype.getClassName=function(){return"SteelWall"},SteelWall.prototype.getImage=function(){return"wall_steel"},Cursor.subclass(Sprite),Cursor.Event={},Cursor.Event.BUILD="Cursor.Event.BUILD",Cursor.Event.MOVED="Cursor.Event.MOVED",Cursor.prototype.toNormalSpeed=function(){Sprite.prototype.toNormalSpeed.call(this),this._moved=!1},Cursor.prototype.setMoveDelay=function(t){this._moveDelay=t},Cursor.prototype.build=function(){this._eventManager.fireEvent({name:Cursor.Event.BUILD,cursor:this})},Cursor.prototype.notify=function(t){t.name==CollisionDetector.Event.OUT_OF_BOUNDS&&t.sprite===this&&this.resolveOutOfBounds(t.bounds)},Cursor.prototype.move=function(){this._moved&&(this._moveTimer++,this._moveTimer<=this._moveDelay)||(Sprite.prototype.move.call(this),this._moveTimer=0,this._moved=!0)},Cursor.prototype.moveHook=function(){this._eventManager.fireEvent({name:Cursor.Event.MOVED,cursor:this})},Cursor.prototype.updateHook=function(){this._blinkTimer.update()},Cursor.prototype.draw=function(t){this._blinkTimer.isVisible()&&t.drawImage(ImageManager.getImage("tank_player1_up_c0_t1"),this._x,this._y)},BlinkTimer.prototype.update=function(){this._timer++,this._timer==this._duration&&(this._timer=0,this._visible=!this._visible)},BlinkTimer.prototype.setDuration=function(t){this._duration=t},BlinkTimer.prototype.isVisible=function(){return this._visible},CursorController.subclass(SpriteController),CursorController.prototype.notify=function(t){SpriteController.prototype.notify.call(this,t),t.name==Cursor.Event.MOVED&&this._spacePressed&&t.cursor.build()},CursorController.prototype.keyPressed=function(t){SpriteController.prototype.keyPressed.call(this,t),t!=Keyboard.Key.SPACE||this._spacePressed||(this._spacePressed=!0,this._sprite.build())},CursorController.prototype.keyReleased=function(t){SpriteController.prototype.keyReleased.call(this,t),t==Keyboard.Key.SPACE&&(this._spacePressed=!1)},Builder.Structure={},Builder.Structure.BRICK_WALL_RIGHT="Builder.Structure.BRICK_WALL_RIGHT",Builder.Structure.BRICK_WALL_BOTTOM="Builder.Structure.BRICK_WALL_BOTTOM",Builder.Structure.BRICK_WALL_LEFT="Builder.Structure.BRICK_WALL_LEFT",Builder.Structure.BRICK_WALL_TOP="Builder.Structure.BRICK_WALL_TOP",Builder.Structure.BRICK_WALL_FULL="Builder.Structure.BRICK_WALL_FULL",Builder.Structure.STEEL_WALL_RIGHT="Builder.Structure.STEEL_WALL_RIGHT",Builder.Structure.STEEL_WALL_BOTTOM="Builder.Structure.STEEL_WALL_BOTTOM",Builder.Structure.STEEL_WALL_LEFT="Builder.Structure.STEEL_WALL_LEFT",Builder.Structure.STEEL_WALL_TOP="Builder.Structure.STEEL_WALL_TOP",Builder.Structure.STEEL_WALL_FULL="Builder.Structure.STEEL_WALL_FULL",Builder.Structure.WATER="Builder.Structure.WATER",Builder.Structure.TREES="Builder.Structure.TREES",Builder.Structure.CLEAR="Builder.Structure.CLEAR",Builder.Event={},Builder.Event.STRUCTURE_CREATED="Builder.Event.STRUCTURE_CREATED",Builder.prototype.setTileSize=function(t){this._tileSize=t},Builder.prototype.setStructure=function(t){this._structure=t},Builder.prototype.notify=function(t){t.name==Cursor.Event.BUILD?this.build(t.cursor):t.name==Cursor.Event.MOVED&&this._prevStructure()},Builder.prototype.build=function(t){var e;this._structure==Builder.Structure.BRICK_WALL_RIGHT?e=this.buildBrickWallRight(t.getPosition()):this._structure==Builder.Structure.BRICK_WALL_BOTTOM?e=this.buildBrickWallBottom(t.getPosition()):this._structure==Builder.Structure.BRICK_WALL_LEFT?e=this.buildBrickWallLeft(t.getPosition()):this._structure==Builder.Structure.BRICK_WALL_TOP?e=this.buildBrickWallTop(t.getPosition()):this._structure==Builder.Structure.BRICK_WALL_FULL?e=this.buildBrickWallFull(t.getPosition()):this._structure==Builder.Structure.STEEL_WALL_RIGHT?e=this.buildSteelWallRight(t.getPosition()):this._structure==Builder.Structure.STEEL_WALL_BOTTOM?e=this.buildSteelWallBottom(t.getPosition()):this._structure==Builder.Structure.STEEL_WALL_LEFT?e=this.buildSteelWallLeft(t.getPosition()):this._structure==Builder.Structure.STEEL_WALL_TOP?e=this.buildSteelWallTop(t.getPosition()):this._structure==Builder.Structure.STEEL_WALL_FULL?e=this.buildSteelWallFull(t.getPosition()):this._structure==Builder.Structure.WATER?e=this.buildWater(t.getPosition()):this._structure==Builder.Structure.TREES?e=this.buildTrees(t.getPosition()):this._structure==Builder.Structure.CLEAR&&(e=this.clear(t.getPosition())),this._eventManager.fireEvent({name:Builder.Event.STRUCTURE_CREATED,structure:e,cursor:t}),this._nextStructure()},Builder.prototype.buildBrickWallRight=function(t){return this._buildWallRight(t,new BrickWallFactory(this._eventManager))},Builder.prototype.buildBrickWallBottom=function(t){return this._buildWallBottom(t,new BrickWallFactory(this._eventManager))},Builder.prototype.buildBrickWallLeft=function(t){return this._buildWallLeft(t,new BrickWallFactory(this._eventManager))},Builder.prototype.buildBrickWallTop=function(t){return this._buildWallTop(t,new BrickWallFactory(this._eventManager))},Builder.prototype.buildBrickWallFull=function(t){return this._buildWallFull(t,new BrickWallFactory(this._eventManager))},Builder.prototype.buildSteelWallRight=function(t){return this._buildWallRight(t,new SteelWallFactory(this._eventManager))},Builder.prototype.buildSteelWallBottom=function(t){return this._buildWallBottom(t,new SteelWallFactory(this._eventManager))},Builder.prototype.buildSteelWallLeft=function(t){return this._buildWallLeft(t,new SteelWallFactory(this._eventManager))},Builder.prototype.buildSteelWallTop=function(t){return this._buildWallTop(t,new SteelWallFactory(this._eventManager))},Builder.prototype.buildSteelWallFull=function(t){return this._buildWallFull(t,new SteelWallFactory(this._eventManager))},Builder.prototype.buildWater=function(t){var e=[],i=new Water(this._eventManager);return i.setPosition(t),i.stopAnimation(),e.push(i),e},Builder.prototype.buildTrees=function(t){var e=[],i=new Trees(this._eventManager);return i.setPosition(t),e.push(i),e},Builder.prototype.clear=function(t){return[]},Builder.prototype._buildWallRight=function(t,e){var i=[],n=e.create();n.setX(t.getX()+this._tileSize),n.setY(t.getY()),i.push(n);var r=e.create();return r.setX(t.getX()+this._tileSize),r.setY(t.getY()+this._tileSize),i.push(r),i},Builder.prototype._buildWallBottom=function(t,e){var i=[],n=e.create();n.setX(t.getX()),n.setY(t.getY()+this._tileSize),i.push(n);var r=e.create();return r.setX(t.getX()+this._tileSize),r.setY(t.getY()+this._tileSize),i.push(r),i},Builder.prototype._buildWallLeft=function(t,e){var i=[],n=e.create();n.setX(t.getX()),n.setY(t.getY()),i.push(n);var r=e.create();return r.setX(t.getX()),r.setY(t.getY()+this._tileSize),i.push(r),i},Builder.prototype._buildWallTop=function(t,e){var i=[],n=e.create();n.setX(t.getX()),n.setY(t.getY()),i.push(n);var r=e.create();return r.setX(t.getX()+this._tileSize),r.setY(t.getY()),i.push(r),i},Builder.prototype._buildWallFull=function(t,e){var i=[],n=e.create();n.setX(t.getX()),n.setY(t.getY()),i.push(n);var r=e.create();r.setX(t.getX()+this._tileSize),r.setY(t.getY()),i.push(r);var a=e.create();a.setX(t.getX()),a.setY(t.getY()+this._tileSize),i.push(a);var l=e.create();return l.setX(t.getX()+this._tileSize),l.setY(t.getY()+this._tileSize),i.push(l),i},Builder.prototype._nextStructure=function(){this._prevStructureIndex=this._structureIndex,this._structureIndex++,this._structureIndex>=this._structures.length&&(this._structureIndex=0),this._structure=this._structures[this._structureIndex]},Builder.prototype._prevStructure=function(){this._structureIndex=this._prevStructureIndex,this._structure=this._structures[this._structureIndex]},StructureManager.prototype.destroySpritesUnderCursor=function(t){var e=t.getRect();this._sprites.forEach((function(t){t.intersects(e)&&t.destroy()}))},StructureManager.prototype.removeSprite=function(t){arrayRemove(this._sprites,t)},StructureManager.prototype.addStructure=function(t){t.forEach((function(t){this.addSprite(t)}),this)},StructureManager.prototype.addSprite=function(t){this._sprites.push(t)},StructureManager.prototype.containsSprite=function(t){return arrayContains(this._sprites,t)},StructureManager.prototype.getSprites=function(){return this._sprites},StructureManager.prototype.notify=function(t){t.name==Builder.Event.STRUCTURE_CREATED?(this.destroySpritesUnderCursor(t.cursor),this.addStructure(t.structure)):t.name==Sprite.Event.DESTROYED&&this.removeSprite(t.sprite)},BrickWallFactory.prototype.create=function(){return new BrickWall(this._eventManager)},SteelWallFactory.prototype.create=function(){return new SteelWall(this._eventManager)},Globals={},Globals.UNIT_SIZE=32,Globals.TILE_SIZE=Globals.UNIT_SIZE/2,Globals.CANVAS_WIDTH=16*Globals.UNIT_SIZE,Globals.CANVAS_HEIGHT=14*Globals.UNIT_SIZE,Base.subclass(Sprite),Base.Event={},Base.Event.HIT="Base.Event.HIT",Base.prototype.getClassName=function(){return"Base"},Base.prototype.draw=function(t){t.drawImage(ImageManager.getImage(this.getImage()),this._x,this._y)},Base.prototype.getImage=function(){var t="base";return this._hit&&(t+="_destroyed"),t},Base.prototype.notify=function(t){this._isHitByBullet(t)&&this.hit()},Base.prototype.hit=function(){this._hit||(this._hit=!0,this._eventManager.fireEvent({name:Base.Event.HIT,base:this}))},Base.prototype.isHit=function(){return this._hit},Base.prototype._isHitByBullet=function(t){return t.name==CollisionDetector.Event.COLLISION&&t.initiator instanceof Bullet&&t.sprite===this},TankStateAppearing.Event={},TankStateAppearing.Event.END="TankStateAppearing.Event.END",TankStateAppearing.prototype.getImage=function(){return"appear_"+this._animation.getFrame()},TankStateAppearing.prototype.update=function(){this._tank.isPaused()||(this._animation.update(),this._animation.isCompleted()&&this._eventManager.fireEvent({name:TankStateAppearing.Event.END,tank:this._tank}))},TankStateAppearing.prototype.draw=function(t){t.drawImage(ImageManager.getImage(this.getImage()),this._tank.getX(),this._tank.getY())},TankStateAppearing.prototype.canMove=function(){return!1},TankStateAppearing.prototype.canShoot=function(){return!1},TankStateAppearing.prototype.canBeDestroyed=function(){return!1},TankStateAppearing.prototype.isCollidable=function(){return!1},TankStateAppearing.prototype.setFrames=function(t){this._animation.setFrames(t)},TankStateAppearing.prototype.setFrameDuration=function(t){this._animation.setFrameDuration(t)},TankStateNormal.prototype.getImage=function(){var t="tank_"+this._tank.getType()+"_"+this._tank.getDirection()+"_c"+this._tank.getColorValue()+"_t"+this._trackAnimation.getFrame();return this._tank.isFlashing()&&this._flashed&&this._tank.isNotHit()&&(t+="_f"),this._tank.getUpgradeLevel()&&(t+="_s"+this._tank.getUpgradeLevel()),t},TankStateNormal.prototype.update=function(){this._tank.isPaused()||this.updateTrackAnimation(),this.updateFlash(),this._tank.updateColor()},TankStateNormal.prototype.updateTrackAnimation=function(){0!=this._tank.getSpeed()&&this._trackAnimation.update()},TankStateNormal.prototype.draw=function(t){t.drawImage(ImageManager.getImage(this.getImage()),this._tank.getX(),this._tank.getY())},TankStateNormal.prototype.canMove=function(){return!0},TankStateNormal.prototype.canShoot=function(){return!0},TankStateNormal.prototype.canBeDestroyed=function(){return!0},TankStateNormal.prototype.isCollidable=function(){return!0},TankStateNormal.prototype.getTrackFrame=function(){return this._trackAnimation.getFrame()},TankStateNormal.prototype.setFlashDuration=function(t){this._flashDuration=t},TankStateNormal.prototype.isFlashed=function(){return this._flashed},TankStateNormal.prototype.setFlashed=function(t){this._flashed=t},TankStateNormal.prototype.updateFlash=function(){this._flashTimer++,this._flashTimer>=this._flashDuration&&(this._flashTimer=0,this._flashed=!this._flashed)},TankStateInvincible.subclass(TankStateNormal),TankStateInvincible.Event={},TankStateInvincible.Event.END="TankStateInvincible.Event.END",TankStateInvincible.prototype.update=function(){TankStateNormal.prototype.update.call(this),this._shieldAnimation.update(),this._tank.isPaused()||this.updateStateTimer()},TankStateInvincible.prototype.draw=function(t){TankStateNormal.prototype.draw.call(this,t),t.drawImage(ImageManager.getImage(this.getShieldImage()),this._tank.getX(),this._tank.getY()+1)},TankStateInvincible.prototype.getShieldImage=function(){return"shield_"+this._shieldAnimation.getFrame()},TankStateInvincible.prototype.updateStateTimer=function(){this._stateTimer++,this._stateTimer>this._stateDuration&&this._eventManager.fireEvent({name:TankStateInvincible.Event.END,tank:this._tank})},TankStateInvincible.prototype.setStateDuration=function(t){this._stateDuration=t},TankStateInvincible.prototype.getStateDuration=function(){return this._stateDuration},TankStateInvincible.prototype.setShieldFrameDuration=function(t){this._shieldAnimation.setFrameDuration(t)},TankStateInvincible.prototype.canBeDestroyed=function(){return!1},AITankController.Event={},AITankController.Event.CREATED="AITankController.Event.CREATED",AITankController.Event.DESTROYED="AITankController.Event.DESTROYED",AITankController.prototype.setShootInterval=function(t){this._shootInterval=t},AITankController.prototype.setShootProbability=function(t){this._shootProbability=t},AITankController.prototype.updateShoot=function(){this._shootTimer++,this._shootTimer>=this._shootInterval&&(this._shootTimer=0,this._random.getNumber()<this._shootProbability&&this._tank.shoot())},AITankController.prototype.setDirectionUpdateInterval=function(t){this._directionUpdateInterval=t},AITankController.prototype.setDirectionUpdateProbability=function(t){this._directionUpdateProbability=t},AITankController.prototype.updateDirection=function(){if(this._directionTimer++,this._directionTimer>=this._directionUpdateInterval&&(this._directionTimer=0,this._random.getNumber()<this._directionUpdateProbability)){var t=this._spriteContainer.getBase(),e=this._random.getNumber(),i=Sprite.Direction.DOWN;t.getY()>this._tank.getY()?(i=Sprite.Direction.DOWN,e<.4&&(i=arrayRandomElement([Sprite.Direction.UP,Sprite.Direction.LEFT,Sprite.Direction.RIGHT]))):t.getY()==this._tank.getY()?t.getX()<this._tank.getX()?(i=Sprite.Direction.LEFT,e<.4&&(i=arrayRandomElement([Sprite.Direction.UP,Sprite.Direction.DOWN,Sprite.Direction.RIGHT]))):t.getX()>this._tank.getX()&&(i=Sprite.Direction.RIGHT,e<.4&&(i=arrayRandomElement([Sprite.Direction.UP,Sprite.Direction.LEFT,Sprite.Direction.DOWN]))):i=arrayRandomElement([Sprite.Direction.UP,Sprite.Direction.DOWN,Sprite.Direction.LEFT,Sprite.Direction.RIGHT]),this._tank.setDirection(i)}},AITankController.prototype.update=function(){this._freezed||this._pauseListener.isPaused()||(this.updateShoot(),this.updateDirection())},AITankController.prototype.notify=function(t){t.name==Tank.Event.DESTROYED&&t.tank===this._tank?this.destroy():t.name==PowerUpHandler.Event.FREEZE?this.freeze():t.name==FreezeTimer.Event.UNFREEZE&&this.unfreeze()},AITankController.prototype.destroy=function(){this._pauseListener.destroy(),this._eventManager.removeSubscriber(this),this._eventManager.fireEvent({name:AITankController.Event.DESTROYED,controller:this})},AITankController.prototype.isFreezed=function(){return this._freezed},AITankController.prototype.freeze=function(){this._freezed=!0,this._tank.stop()},AITankController.prototype.unfreeze=function(){this._freezed=!1,this._tank.toNormalSpeed()},AITankController.prototype.setPauseListener=function(t){this._pauseListener.destroy(),this._pauseListener=t},Random.prototype.getNumber=function(){return Math.random()},AITankControllerFactory.prototype.notify=function(t){t.name==EnemyFactory.Event.ENEMY_CREATED?this.createController(t.enemy):t.name==PowerUpHandler.Event.FREEZE?this.freeze():t.name==FreezeTimer.Event.UNFREEZE&&this.unfreeze()},AITankControllerFactory.prototype.createController=function(t){var e=new AITankController(t,new Random,this._spriteContainer);return this.isFreezed()&&e.freeze(),e},AITankControllerFactory.prototype.isFreezed=function(){return this._freezed},AITankControllerFactory.prototype.freeze=function(){this._freezed=!0},AITankControllerFactory.prototype.unfreeze=function(){this._freezed=!1},AITankControllerContainer.prototype.addController=function(t){this._controllers.push(t)},AITankControllerContainer.prototype.removeController=function(t){arrayRemove(this._controllers,t)},AITankControllerContainer.prototype.containsController=function(t){return arrayContains(this._controllers,t)},AITankControllerContainer.prototype.getControllers=function(){return this._controllers},AITankControllerContainer.prototype.notify=function(t){t.name==AITankController.Event.CREATED?this.addController(t.controller):t.name==AITankController.Event.DESTROYED&&this.removeController(t.controller)},AITankControllerContainer.prototype.update=function(){this._controllers.forEach((function(t){t.update()}))},EnemyFactory.Event={},EnemyFactory.Event.ENEMY_CREATED="EnemyFactory.Event.ENEMY_CREATED",EnemyFactory.Event.LAST_ENEMY_DESTROYED="EnemyFactory.Event.LAST_ENEMY_DESTROYED",EnemyFactory.prototype.setEnemies=function(t){this._enemies=t},EnemyFactory.prototype.setPositions=function(t){this._positions=t},EnemyFactory.prototype.update=function(){this._pauseListener.isPaused()||(this._timer++,this._timer>this._interval&&this.create())},EnemyFactory.prototype.getNextPosition=function(){return this._positions[this._position]},EnemyFactory.prototype.nextPosition=function(){this._position++,this._position>=this._positions.length&&(this._position=0)},EnemyFactory.prototype.create=function(){this._noMoreEnemies()||this._enemyCountLimitReached()||(this._timer=0,this.createNextEnemy())},EnemyFactory.prototype.setInterval=function(t){this._interval=t,this._timer=this._interval},EnemyFactory.prototype.setFlashingTanks=function(t){this._flashingTanks=t},EnemyFactory.prototype.createNextEnemy=function(){var t=this.createEnemy(this.getNextEnemy(),this.getNextPosition());return this.nextEnemy(),this.nextPosition(),t},EnemyFactory.prototype.createEnemy=function(t,e){var i=new Tank(this._eventManager);return i.makeEnemy(),i.setType(t),i.setPosition(e),i.setState(new TankStateAppearing(i)),t==Tank.Type.BASIC?(i.setMoveFrequency(2),i.setTrackAnimationDuration(4),i.setValue(100)):t==Tank.Type.FAST?(i.setNormalSpeed(3),i.setValue(200)):t==Tank.Type.POWER?(i.setBulletSpeed(Bullet.Speed.FAST),i.setValue(300)):t==Tank.Type.ARMOR&&(i.setMoveFrequency(2),i.setTrackAnimationDuration(4),i.setHitLimit(4),i.setColorValues([[0,1],[0,2],[1,2],[0,0]]),i.setValue(400)),arrayContains(this._flashingTanks,this._enemy+1)&&i.startFlashing(),this._eventManager.fireEvent({name:EnemyFactory.Event.ENEMY_CREATED,enemy:i}),this._enemyCount++,i},EnemyFactory.prototype.getNextEnemy=function(){return this._enemies[this._enemy]},EnemyFactory.prototype.nextEnemy=function(){this._enemy++},EnemyFactory.prototype.getEnemyCount=function(){return this._enemyCount},EnemyFactory.prototype.getEnemiesToCreateCount=function(){return this._enemies.length-this._enemy},EnemyFactory.prototype.notify=function(t){t.name==TankExplosion.Event.DESTROYED&&(t.explosion.getTank().isEnemy()&&this._enemyCount--,t.explosion.getTank().isEnemy()&&this._enemyCount<=0&&0==this.getEnemiesToCreateCount()&&this._eventManager.fireEvent({name:EnemyFactory.Event.LAST_ENEMY_DESTROYED}))},EnemyFactory.prototype.setEnemyCountLimit=function(t){this._enemyCountLimit=t},EnemyFactory.prototype._noMoreEnemies=function(){return this._enemy>=this._enemies.length},EnemyFactory.prototype._enemyCountLimitReached=function(){return this._enemyCount>=this._enemyCountLimit},Animation.prototype.setActive=function(t){this._active=t},Animation.prototype.update=function(){this._active&&!this._completed&&(this._timer++,this._timer>=this._frameDuration&&(this._timer=0,this._frame++,this._frame>=this._frames.length&&(this._loop?this._frame=0:(this._frame=this._frames.length-1,this._completed=!0))))},Animation.prototype.getFrame=function(){return this._frames[this._frame]},Animation.prototype.setFrames=function(t){this._frames=t},Animation.prototype.setFrameDuration=function(t){this._frameDuration=t},Animation.prototype.isCompleted=function(){return this._completed},TankExplosionFactory.prototype.setExplosionSize=function(t){this._explosionSize=t},TankExplosionFactory.prototype.getExplosionSize=function(){return this._explosionSize},TankExplosionFactory.prototype.notify=function(t){t.name==Tank.Event.DESTROYED&&this.create(t.tank)},TankExplosionFactory.prototype.create=function(t){var e=new TankExplosion(this._eventManager,t),i=t.getCenter();return e.setRect(new Rect(i.getX()-this._explosionSize/2,i.getY()-this._explosionSize/2,this._explosionSize,this._explosionSize)),t._player?SoundManager.play("explosion_1"):SoundManager.play("enemy_explosion"),e},TankExplosion.subclass(Explosion),TankExplosion.Event={},TankExplosion.Event.DESTROYED="TankExplosion.Event.DESTROYED",TankExplosion.prototype.getImage=function(){return"big_explosion_"+this._animation.getFrame()},TankExplosion.prototype.destroyHook=function(){this._eventManager.fireEvent({name:TankExplosion.Event.DESTROYED,explosion:this})},TankExplosion.prototype.getTank=function(){return this._tank},PointsFactory.Event={},PointsFactory.Event.POINTS_CREATED="PointsFactory.Event.POINTS_CREATED",PointsFactory.prototype.notify=function(t){if(this._enemyTankExplosionEnd(t)){var e=t.explosion,i=e.getTank();this.create(e.getCenter(),i.getValue(),Points.Type.TANK)}else if(t.name==PowerUp.Event.PICK){var n=t.powerUp;this.create(n.getCenter(),n.getValue(),Points.Type.POWERUP)}},PointsFactory.prototype.create=function(t,e,i){var n=new Points(this._eventManager);return n.setValue(e),n.setRect(new Rect(t.getX()-this._pointsSize/2,t.getY()-this._pointsSize/2,this._pointsSize,this._pointsSize)),n.setType(i),this._eventManager.fireEvent({name:PointsFactory.Event.POINTS_CREATED,points:n}),n},PointsFactory.prototype.setPointsSize=function(t){this._pointsSize=t},PointsFactory.prototype._enemyTankExplosionEnd=function(t){if(t.name!=TankExplosion.Event.DESTROYED)return!1;var e=t.explosion.getTank();return!!e.isEnemy()&&!(e.getValue()<=0)},Points.subclass(Sprite),Points.Type={},Points.Type.TANK="Points.Type.TANK",Points.Type.POWERUP="Points.Type.POWERUP",Points.Event={},Points.Event.DESTROYED="Points.Event.DESTROYED",Points.prototype.setValue=function(t){this._value=t},Points.prototype.getValue=function(){return this._value},Points.prototype.setDuration=function(t){this._duration=t},Points.prototype.setType=function(t){this._type=t},Points.prototype.getType=function(){return this._type},Points.prototype.updateTimer=function(){this._timer++,this._timer>this._duration&&this.destroy()},Points.prototype.updateHook=function(){this._pauseListener.isPaused()||this.updateTimer()},Points.prototype.getImage=function(){return"points_"+this._value},Points.prototype.draw=function(t){t.drawImage(ImageManager.getImage(this.getImage()),this._x,this._y)},Points.prototype.destroyHook=function(){this._eventManager.fireEvent({name:Points.Event.DESTROYED,points:this})},PlayerTankFactory.Event={},PlayerTankFactory.Event.PLAYER_TANK_CREATED="PlayerTankFactory.Event.PLAYER_TANK_CREATED",PlayerTankFactory.prototype.notify=function(t){this._active&&this._tankExplosionDestroyed(t)&&this.create()},PlayerTankFactory.prototype.setAppearPosition=function(t){this._appearPosition=t},PlayerTankFactory.prototype.create=function(){var t=new Tank(this._eventManager);return t.setPosition(this._appearPosition),t.setState(new TankStateAppearing(t)),this._eventManager.fireEvent({name:PlayerTankFactory.Event.PLAYER_TANK_CREATED,tank:t}),t},PlayerTankFactory.prototype.setActive=function(t){this._active=t},PlayerTankFactory.prototype._tankExplosionDestroyed=function(t){return t.name==TankExplosion.Event.DESTROYED&&!!t.explosion.getTank().isPlayer()},PlayerTankControllerFactory.prototype.notify=function(t){t.name==PlayerTankFactory.Event.PLAYER_TANK_CREATED&&this.create(t.tank)},PlayerTankControllerFactory.prototype.create=function(t){return new TankController(this._eventManager,t)},PowerUpFactory.prototype.notify=function(t){t.name==Tank.Event.FLASHING_TANK_DESTROYED&&this.create()},PowerUpFactory.prototype.setPositions=function(t){this._positions=t},PowerUpFactory.prototype.create=function(){var t=new PowerUp(this._eventManager),e=[PowerUp.Type.GRENADE,PowerUp.Type.HELMET,PowerUp.Type.SHOVEL,PowerUp.Type.STAR,PowerUp.Type.TANK,PowerUp.Type.TIMER];return t.setType(arrayRandomElement(e)),t.setPosition(arrayRandomElement(this._positions)),SoundManager.play("powerup_appear"),t},PowerUp.subclass(Sprite),PowerUp.Event={},PowerUp.Event.DESTROYED="PowerUp.Event.DESTROYED",PowerUp.Event.PICK="PowerUp.Event.PICK",PowerUp.Type={},PowerUp.Type.GRENADE="grenade",PowerUp.Type.HELMET="helmet",PowerUp.Type.SHOVEL="shovel",PowerUp.Type.STAR="star",PowerUp.Type.TANK="tank",PowerUp.Type.TIMER="timer",PowerUp.prototype.setType=function(t){this._type=t},PowerUp.prototype.getType=function(){return this._type},PowerUp.prototype.setValue=function(t){this._value=t},PowerUp.prototype.getValue=function(){return this._value},PowerUp.prototype.draw=function(t){this._blinkTimer.isVisible()&&t.drawImage(ImageManager.getImage(this.getImage()),this._x,this._y)},PowerUp.prototype.updateHook=function(){this._blinkTimer.update()},PowerUp.prototype.getImage=function(){return"powerup_"+this._type},PowerUp.prototype.notify=function(t){this._collidedWithPlayer(t)?(this._playerTank=t.initiator,this._eventManager.fireEvent({name:PowerUp.Event.PICK,powerUp:this}),this.destroy()):t.name==EnemyFactory.Event.ENEMY_CREATED&&t.enemy.isFlashing()&&this.destroy()},PowerUp.prototype.destroyHook=function(){this._eventManager.fireEvent({name:PowerUp.Event.DESTROYED,powerUp:this})},PowerUp.prototype.setPlayerTank=function(t){this._playerTank=t},PowerUp.prototype.getPlayerTank=function(){return this._playerTank},PowerUp.prototype._collidedWithPlayer=function(t){return t.name==CollisionDetector.Event.COLLISION&&(t.initiator instanceof Tank&&(!!t.initiator.isPlayer()&&t.sprite===this))},PowerUpHandler.Event={},PowerUpHandler.Event.FREEZE="PowerUpHandler.Event.FREEZE",PowerUpHandler.Event.SHOVEL_START="PowerUpHandler.Event.SHOVEL_START",PowerUpHandler.Event.TANK="PowerUpHandler.Event.TANK",PowerUpHandler.HELMET_DURATION=345,PowerUpHandler.prototype.setSpriteContainer=function(t){this._spriteContainer=t},PowerUpHandler.prototype.notify=function(t){t.name==PowerUp.Event.PICK&&this.handle(t.powerUp)},PowerUpHandler.prototype.handle=function(t){SoundManager.play("powerup_pick"),t.getType()==PowerUp.Type.GRENADE?this.handleGrenade():t.getType()==PowerUp.Type.HELMET?this.handleHelmet(t.getPlayerTank()):t.getType()==PowerUp.Type.TIMER?this.handleTimer():t.getType()==PowerUp.Type.SHOVEL?this.handleShovel():t.getType()==PowerUp.Type.STAR?this.handleStar(t.getPlayerTank()):t.getType()==PowerUp.Type.TANK&&this.handleTank()},PowerUpHandler.prototype.handleGrenade=function(){this._spriteContainer.getEnemyTanks().forEach((function(t){t.setValue(0),t.destroy()}))},PowerUpHandler.prototype.handleHelmet=function(t){var e=new TankStateInvincible(t);e.setStateDuration(PowerUpHandler.HELMET_DURATION),t.setState(e)},PowerUpHandler.prototype.handleTimer=function(){this._eventManager.fireEvent({name:PowerUpHandler.Event.FREEZE})},PowerUpHandler.prototype.handleShovel=function(){this._eventManager.fireEvent({name:PowerUpHandler.Event.SHOVEL_START})},PowerUpHandler.prototype.handleStar=function(t){t.upgrade()},PowerUpHandler.prototype.handleTank=function(){this._eventManager.fireEvent({name:PowerUpHandler.Event.TANK})},FreezeTimer.Event={},FreezeTimer.Event.UNFREEZE="FreezeTimer.Event.UNFREEZE",FreezeTimer.prototype.notify=function(t){t.name==PowerUpHandler.Event.FREEZE&&this.start()},FreezeTimer.prototype.start=function(){this._active=!0,this._timer=0},FreezeTimer.prototype.unfreeze=function(){this._eventManager.fireEvent({name:FreezeTimer.Event.UNFREEZE})},FreezeTimer.prototype.setDuration=function(t){this._duration=t},FreezeTimer.prototype.update=function(){this._pauseListener.isPaused()||this._active&&(this._timer++,this._timer>this._duration&&(this._active=!1,this.unfreeze()))},BaseWallBuilder.prototype.setWallPositions=function(t){this._positions=t},BaseWallBuilder.prototype.setWallFactory=function(t){this._factory=t},BaseWallBuilder.prototype.setSpriteContainer=function(t){this._spriteContainer=t},BaseWallBuilder.prototype.buildWall=function(){this._positions.forEach((function(t){this._factory.create().setPosition(t)}),this)},BaseWallBuilder.prototype.destroyWall=function(){this._spriteContainer.getWalls().forEach((function(t){for(var e=0;e<this._positions.length;++e){var i=this._positions[e];if(t.getX()==i.getX()&&t.getY()==i.getY()){t.destroy();break}}}),this)},ShovelHandler.prototype.setBaseWallBuilder=function(t){this._baseWallBuilder=t},ShovelHandler.prototype.setDuration=function(t){this._duration=t},ShovelHandler.prototype.notify=function(t){t.name==PowerUpHandler.Event.SHOVEL_START&&this.start()},ShovelHandler.prototype.start=function(){this._active=!0,this._timer=0,this.rebuildWall(new SteelWallFactory(this._eventManager))},ShovelHandler.prototype.end=function(){this.rebuildWall(new BrickWallFactory(this._eventManager))},ShovelHandler.prototype.rebuildWall=function(t){this._baseWallBuilder.destroyWall(),this._baseWallBuilder.setWallFactory(t),this._baseWallBuilder.buildWall()},ShovelHandler.prototype.update=function(){this._pauseListener.isPaused()||this.updateTimer()},ShovelHandler.prototype.updateTimer=function(){this._active&&(this._timer++,this._timer>this._duration&&(this._active=!1,this.end()))},Pause.Event={},Pause.Event.START="Pause.Event.START",Pause.Event.END="Pause.Event.END",Pause.prototype.notify=function(t){t.name==Keyboard.Event.KEY_PRESSED&&this.keyPressed(t.key)},Pause.prototype.keyPressed=function(t){this._active&&t==Keyboard.Key.START&&(this._pause=!this._pause,this._pause?(SoundManager.play("pause"),this._eventManager.fireEvent({name:Pause.Event.START})):this._eventManager.fireEvent({name:Pause.Event.END}))},Pause.prototype.update=function(){this._pause&&this._blinkTimer.update()},Pause.prototype.draw=function(t){this._pause&&this._blinkTimer.isVisible()&&(t.fillStyle="#e44437",t.fillText("PAUSE",202,240))},Pause.prototype.setActive=function(t){this._active=t},PauseListener.prototype.notify=function(t){t.name==Pause.Event.START?this.pause():t.name==Pause.Event.END&&this.unpause()},PauseListener.prototype.pause=function(){this._pause=!0},PauseListener.prototype.unpause=function(){this._pause=!1},PauseListener.prototype.isPaused=function(){return this._pause},PauseListener.prototype.destroy=function(){this._eventManager.removeSubscriber(this)},BaseExplosionFactory.prototype.setExplosionSize=function(t){this._explosionSize=t},BaseExplosionFactory.prototype.getExplosionSize=function(){return this._explosionSize},BaseExplosionFactory.prototype.notify=function(t){t.name==Base.Event.HIT&&this.create(t.base)},BaseExplosionFactory.prototype.create=function(t){var e=new BaseExplosion(this._eventManager),i=t.getCenter();return e.setRect(new Rect(i.getX()-this._explosionSize/2,i.getY()-this._explosionSize/2,this._explosionSize,this._explosionSize)),SoundManager.play("explosion_2"),e},BaseExplosion.subclass(Explosion),BaseExplosion.Event={},BaseExplosion.Event.DESTROYED="BaseExplosion.Event.DESTROYED",BaseExplosion.prototype.getImage=function(){return"big_explosion_"+this._animation.getFrame()},BaseExplosion.prototype.destroyHook=function(){this._eventManager.fireEvent({name:BaseExplosion.Event.DESTROYED,explosion:this})},TankColor.prototype.setColors=function(t){this._colors=t},TankColor.prototype.getColor=function(){return this._colors[this._hit][this._color]},TankColor.prototype.update=function(){this._color=0==this._color?1:0},TankColor.prototype.hit=function(){this._hit++,this._hit>=this._colors.length&&(this._hit=this._colors.length-1)},SceneManager.prototype.setScene=function(t){this._scene=t},SceneManager.prototype.getScene=function(){return this._scene},SceneManager.prototype.toLoadingScene=function(){this._eventManager.removeAllSubscribers(),this._scene=new LoadingScene(this)},SceneManager.prototype.toMainMenuScene=function(t){this._eventManager.removeAllSubscribers(),this._scene=new MainMenuScene(this),t&&(this._scene.nextMenuItem(),this._scene.arrived())},SceneManager.prototype.toGameScene=function(t,e){this._eventManager.removeAllSubscribers(),this._scene=new GameScene(this,t,e)},SceneManager.prototype.toConstructionScene=function(){this._eventManager.removeAllSubscribers(),this._scene=new Construction(this)},SceneManager.prototype.toStageStatisticsScene=function(t,e,i){this._eventManager.removeAllSubscribers(),this._scene=new StageStatisticsScene(this,t,e,i)},SceneManager.prototype.toGameOverScene=function(){this._eventManager.removeAllSubscribers(),this._scene=new GameOverScene(this)},SceneManager.prototype.update=function(){this._scene.update()},SceneManager.prototype.draw=function(t){this._scene.draw(t)},SceneManager.prototype.getEventManager=function(){return this._eventManager},MainMenuScene.prototype.setY=function(t){this._y=t},MainMenuScene.prototype.getY=function(){return this._y},MainMenuScene.prototype.setSpeed=function(t){this._speed=t},MainMenuScene.prototype.updatePosition=function(){0!=this._y?(this._y-=this._speed,this._y<=0&&this.arrived()):this._mainMenuController.activate()},MainMenuScene.prototype.arrived=function(){this._y=0,this._cursor.makeVisible()},MainMenuScene.prototype.update=function(){this.updatePosition(),this._cursor.update()},MainMenuScene.prototype.draw=function(t){this._clearCanvas(t),t.drawImage(ImageManager.getImage("battle_city"),75,this._y+80),t.fillStyle="#ffffff",t.drawImage(ImageManager.getImage("roman_one_white"),36,this._y+32),t.fillText("-    00",50,this._y+46),t.fillText("HI- 20000",178,this._y+46),t.drawImage(ImageManager.getImage("copyright"),98,this._y+384),t.fillText("2025 Spinning Cat",123,this._y+398),t.fillText("ALL RIGHTS RESERVED",98,this._y+430),this._mainMenuView.draw(t,this._y)},MainMenuScene.prototype.notify=function(t){t.name==Keyboard.Event.KEY_PRESSED&&this.keyPressed(t.key)},MainMenuScene.prototype.keyPressed=function(t){t!=Keyboard.Key.START&&t!=Keyboard.Key.SELECT||this.arrived()},MainMenuScene.prototype.setCursor=function(t){this._cursor=t},MainMenuScene.prototype.setMainMenuController=function(t){this._mainMenuController=t},MainMenuScene.prototype.nextMenuItem=function(){this._mainMenu.nextItem()},MainMenuScene.prototype._clearCanvas=function(t){t.drawImage(backgroundImage,0,0,t.canvas.width,t.canvas.height)},MainMenuItem.prototype.setName=function(t){this._name=t},MainMenuItem.prototype.getName=function(){return this._name},MainMenuItem.prototype.execute=function(){},OnePlayerMenuItem.subclass(MainMenuItem),OnePlayerMenuItem.prototype.execute=function(){this._sceneManager.toGameScene()},MainMenu.prototype.setItems=function(t){this._items=t},MainMenu.prototype.getCurrentItem=function(){return this._items[this._item]},MainMenu.prototype.isCurrent=function(t){return t===this.getCurrentItem()},MainMenu.prototype.nextItem=function(){this._item++,this._item>=this._items.length&&(this._item=0)},MainMenu.prototype.executeCurrentItem=function(){this.getCurrentItem().execute()},MainMenu.prototype.getItemsInfo=function(){var t=[];return this._items.forEach((function(e){var i={};i.name=e.getName(),i.isCurrent=this.isCurrent(e),t.push(i)}),this),t},MainMenuController.prototype.notify=function(t){t.name==Keyboard.Event.KEY_PRESSED&&this.keyPressed(t.key)},MainMenuController.prototype.keyPressed=function(t){this._active&&(t==Keyboard.Key.SELECT?this._menu.nextItem():t==Keyboard.Key.START&&this._menu.executeCurrentItem())},MainMenuController.prototype.activate=function(){this._active=!0},MainMenuController.prototype.deactivate=function(){this._active=!1},MainMenuCursor.prototype.getTrackFrame=function(){return this._trackAnimation.getFrame()},MainMenuCursor.prototype.update=function(){this._trackAnimation.update()},MainMenuCursor.prototype.makeVisible=function(){this._visible=!0},MainMenuCursor.prototype.isVisible=function(){return this._visible},MainMenuCursorView.prototype.draw=function(t,e,i){this._cursor.isVisible()&&t.drawImage(ImageManager.getImage(this.getImage()),e+40,i)},MainMenuCursorView.prototype.getImage=function(){return"tank_player1_up_c0_t"+this._cursor.getTrackFrame()},Gamefield.subclass(Rect),Gamefield.prototype.update=function(){this._updater.update()},Gamefield.prototype.draw=function(t){t.drawImage(backgroundImage,0,0,t.canvas.width,t.canvas.height),t.fillStyle="#14ff06",t.fillRect(this._x,this._y,this._w,this._h),this._painter.draw(t)},Level.subclass(Gamefield),Level.prototype.update=function(){Gamefield.prototype.update.call(this),this._enemyFactory.update(),this._aiControllersContainer.update(),this._freezeTimer.update(),this._shovelHandler.update(),this._pause.update(),this._gameOverScript.update(),this._levelTransitionScript.update()},Level.prototype.draw=function(t){this._visible&&(Gamefield.prototype.draw.call(this,t),this._enemyFactoryView.draw(t),this._pause.draw(t),this._livesView.draw(t),this._gameOverMessage.draw(t))},Level.prototype.show=function(){this._visible=!0},Level.prototype.notify=function(t){t.name==BaseExplosion.Event.DESTROYED?(this._gameOverScript.setActive(!0),this._pause.setActive(!1)):t.name==Player.Event.OUT_OF_LIVES?(this._gameOverScript.setActive(!0),this._pause.setActive(!1),this._playerTankFactory.setActive(!1)):t.name==EnemyFactory.Event.LAST_ENEMY_DESTROYED&&this._levelTransitionScript.setActive(!0)},Level.prototype._loadStage=function(t){var e=Globals.stages[(t-1)%Globals.stages.length];new SpriteSerializer(this._eventManager).unserializeSprites(e.map),this._enemyFactory.setEnemies(e.tanks)},Level.prototype._createPowerUpFactory=function(){var t=new PowerUpFactory(this._eventManager),e=this._x+Globals.UNIT_SIZE+15,i=this._x+4*Globals.UNIT_SIZE+15,n=this._x+7*Globals.UNIT_SIZE+15,r=this._x+10*Globals.UNIT_SIZE+15,a=this._y+Globals.UNIT_SIZE+17,l=this._y+4*Globals.UNIT_SIZE+17,o=this._y+7*Globals.UNIT_SIZE+17,s=this._y+10*Globals.UNIT_SIZE+17;t.setPositions([new Point(e,a),new Point(i,a),new Point(n,a),new Point(r,a),new Point(e,l),new Point(i,l),new Point(n,l),new Point(r,l),new Point(e,o),new Point(i,o),new Point(n,o),new Point(r,o),new Point(e,s),new Point(i,s),new Point(n,s),new Point(r,s)])},EnemyFactoryView.prototype.draw=function(t){for(var e=0;e<this._enemyFactory.getEnemiesToCreateCount();++e){var i=465+Globals.TILE_SIZE*(e%2),n=34+Globals.TILE_SIZE*Math.floor(e/2);t.drawImage(ImageManager.getImage("enemy"),i,n)}},LivesView.prototype.draw=function(t){t.fillStyle="#000000",t.font="16px prstart",t.fillText(this._player.getLives(),482,286),t.drawImage(ImageManager.getImage("lives"),465,272)},MainMenuView.prototype.draw=function(t,e){t.fillStyle="#ffffff";for(var i=this._menu.getItemsInfo(),n=0;n<i.length;++n){var r=e+270+32*n;t.fillText(i[n].name,178,r),i[n].isCurrent&&this._cursorView.draw(t,128,r-23)}},Curtain.prototype.setHeight=function(t){this._height=t},Curtain.prototype.setSpeed=function(t){this._speed=t},Curtain.prototype.getPosition=function(){return this._position},Curtain.prototype.setPosition=function(t){this._position=t},Curtain.prototype.fall=function(){this.isFallen()||(this._position+=this._speed,this.isFallen()&&(this._position=this._height))},Curtain.prototype.rise=function(){this.isRisen()||(this._position-=this._speed,this.isRisen()&&(this._position=0))},Curtain.prototype.isFallen=function(){return this._position>=this._height},Curtain.prototype.isRisen=function(){return this._position<=0},Curtain.prototype.draw=function(t){t.fillStyle="#14ff06",t.fillRect(0,0,Globals.CANVAS_WIDTH,this._position),t.fillRect(0,Globals.CANVAS_HEIGHT-this._position,Globals.CANVAS_WIDTH,Globals.CANVAS_HEIGHT)},Script.prototype.enqueue=function(t){this._nodes.push(t)},Script.prototype.update=function(){if(this._active){for(;;){if(0==this._nodes.length)return;if(void 0!==this._nodes[0].update)break;this._nodes[0].execute(),this._nodes.shift()}this._nodes[0].update()}},Script.prototype.actionCompleted=function(){this._nodes.shift()},Script.prototype.setActive=function(t){this._active=t},Delay.prototype.update=function(){this._timer++,this._timer>this._duration&&this._script.actionCompleted()},GameScene.prototype.update=function(){this._script.update()},GameScene.prototype.draw=function(t){t.drawImage(backgroundImage,0,0,t.canvas.width,t.canvas.height),this._level.draw(t),this._curtain.draw(t),this._stageMessage.draw(t)},StageMessage.prototype.show=function(){this._visible=!0},StageMessage.prototype.hide=function(){this._visible=!1},StageMessage.prototype.draw=function(t){this._visible&&(t.fillStyle="#14ff06",t.fillText("STAGE "+(""+this._stage).lpad(" ",2),195,222))},Globals.stages=[],Globals.stages.push({map:"Base(224,400);BrickWall(208,416);BrickWall(208,400);BrickWall(208,384);BrickWall(224,384);BrickWall(240,384);BrickWall(256,384);BrickWall(256,400);BrickWall(256,416);BrickWall(64,368);BrickWall(80,368);BrickWall(64,384);BrickWall(80,384);BrickWall(64,336);BrickWall(80,336);BrickWall(64,352);BrickWall(80,352);BrickWall(64,304);BrickWall(80,304);BrickWall(64,320);BrickWall(80,320);BrickWall(128,304);BrickWall(144,304);BrickWall(128,320);BrickWall(144,320);BrickWall(128,336);BrickWall(144,336);BrickWall(128,352);BrickWall(144,352);BrickWall(128,368);BrickWall(144,368);BrickWall(128,384);BrickWall(144,384);BrickWall(192,304);BrickWall(208,304);BrickWall(192,320);BrickWall(208,320);BrickWall(192,272);BrickWall(208,272);BrickWall(192,288);BrickWall(208,288);BrickWall(224,272);BrickWall(240,272);BrickWall(224,288);BrickWall(240,288);BrickWall(256,272);BrickWall(272,272);BrickWall(256,288);BrickWall(272,288);BrickWall(256,304);BrickWall(272,304);BrickWall(256,320);BrickWall(272,320);BrickWall(320,368);BrickWall(336,368);BrickWall(320,384);BrickWall(336,384);BrickWall(320,336);BrickWall(336,336);BrickWall(320,352);BrickWall(336,352);BrickWall(320,304);BrickWall(336,304);BrickWall(320,320);BrickWall(336,320);BrickWall(384,304);BrickWall(400,304);BrickWall(384,320);BrickWall(400,320);BrickWall(384,336);BrickWall(400,336);BrickWall(384,352);BrickWall(400,352);BrickWall(384,368);BrickWall(400,368);BrickWall(384,384);BrickWall(400,384);BrickWall(192,336);BrickWall(208,336);BrickWall(256,336);BrickWall(272,336);BrickWall(128,288);BrickWall(144,288);BrickWall(64,288);BrickWall(80,288);BrickWall(320,288);BrickWall(336,288);BrickWall(384,288);BrickWall(400,288);BrickWall(256,256);BrickWall(272,256);BrickWall(192,256);BrickWall(208,256);SteelWall(32,240);SteelWall(48,240);SteelWall(416,240);SteelWall(432,240);BrickWall(352,240);BrickWall(368,240);BrickWall(320,240);BrickWall(336,240);BrickWall(96,240);BrickWall(112,240);BrickWall(128,240);BrickWall(144,240);BrickWall(32,224);BrickWall(48,224);BrickWall(96,224);BrickWall(112,224);BrickWall(128,224);BrickWall(144,224);BrickWall(320,224);BrickWall(336,224);BrickWall(352,224);BrickWall(368,224);BrickWall(416,224);BrickWall(432,224);BrickWall(192,208);BrickWall(208,208);BrickWall(256,208);BrickWall(272,208);BrickWall(256,192);BrickWall(272,192);BrickWall(192,192);BrickWall(208,192);BrickWall(128,176);BrickWall(144,176);BrickWall(64,176);BrickWall(80,176);BrickWall(320,176);BrickWall(336,176);BrickWall(384,176);BrickWall(400,176);BrickWall(256,144);BrickWall(272,144);BrickWall(192,144);BrickWall(208,144);BrickWall(128,144);BrickWall(144,144);BrickWall(128,160);BrickWall(144,160);BrickWall(64,144);BrickWall(80,144);BrickWall(64,160);BrickWall(80,160);BrickWall(64,112);BrickWall(80,112);BrickWall(64,128);BrickWall(80,128);BrickWall(64,80);BrickWall(80,80);BrickWall(64,96);BrickWall(80,96);BrickWall(64,48);BrickWall(80,48);BrickWall(64,64);BrickWall(80,64);BrickWall(128,48);BrickWall(144,48);BrickWall(128,64);BrickWall(144,64);BrickWall(128,80);BrickWall(144,80);BrickWall(128,96);BrickWall(144,96);BrickWall(128,112);BrickWall(144,112);BrickWall(128,128);BrickWall(144,128);BrickWall(192,112);BrickWall(208,112);BrickWall(192,128);BrickWall(208,128);BrickWall(192,80);BrickWall(208,80);BrickWall(192,96);BrickWall(208,96);BrickWall(192,48);BrickWall(208,48);BrickWall(192,64);BrickWall(208,64);BrickWall(256,48);BrickWall(272,48);BrickWall(256,64);BrickWall(272,64);BrickWall(256,80);BrickWall(272,80);BrickWall(256,96);BrickWall(272,96);BrickWall(256,112);BrickWall(272,112);BrickWall(256,128);BrickWall(272,128);BrickWall(320,144);BrickWall(336,144);BrickWall(320,160);BrickWall(336,160);BrickWall(320,112);BrickWall(336,112);BrickWall(320,128);BrickWall(336,128);BrickWall(320,80);BrickWall(336,80);BrickWall(320,96);BrickWall(336,96);BrickWall(320,48);BrickWall(336,48);BrickWall(320,64);BrickWall(336,64);BrickWall(384,48);BrickWall(400,48);BrickWall(384,64);BrickWall(400,64);BrickWall(384,80);BrickWall(400,80);BrickWall(384,96);BrickWall(400,96);BrickWall(384,112);BrickWall(400,112);BrickWall(384,128);BrickWall(400,128);BrickWall(384,144);BrickWall(400,144);BrickWall(384,160);BrickWall(400,160);SteelWall(224,112);SteelWall(240,112);SteelWall(224,128);SteelWall(240,128)",tanks:[Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.FAST,Tank.Type.FAST]}),Globals.stages.push({map:"Base(224,400);BrickWall(208,416);BrickWall(208,400);BrickWall(208,384);BrickWall(224,384);BrickWall(240,384);BrickWall(256,384);BrickWall(256,400);BrickWall(256,416);BrickWall(64,48);BrickWall(80,48);BrickWall(64,64);BrickWall(80,64);BrickWall(64,80);BrickWall(80,80);BrickWall(64,96);BrickWall(80,96);Trees(32,144);Trees(32,176);Trees(64,176);BrickWall(64,208);BrickWall(80,208);BrickWall(64,224);BrickWall(80,224);BrickWall(96,208);BrickWall(112,208);BrickWall(96,224);BrickWall(112,224);BrickWall(128,208);BrickWall(144,208);BrickWall(128,224);BrickWall(144,224);BrickWall(64,272);BrickWall(80,272);BrickWall(64,288);BrickWall(80,288);BrickWall(64,304);BrickWall(80,304);BrickWall(64,320);BrickWall(80,320);BrickWall(64,336);BrickWall(80,336);BrickWall(64,352);BrickWall(80,352);BrickWall(64,368);BrickWall(80,368);BrickWall(64,384);BrickWall(80,384);BrickWall(64,400);BrickWall(80,400);BrickWall(64,416);BrickWall(80,416);SteelWall(32,272);SteelWall(48,272);SteelWall(32,288);SteelWall(48,288);SteelWall(128,48);SteelWall(144,48);SteelWall(128,64);SteelWall(144,64);SteelWall(128,16);SteelWall(144,16);SteelWall(128,32);SteelWall(144,32);BrickWall(128,112);BrickWall(144,112);BrickWall(128,128);BrickWall(144,128);BrickWall(128,144);BrickWall(144,144);BrickWall(128,160);BrickWall(144,160);BrickWall(192,176);BrickWall(208,176);BrickWall(192,192);BrickWall(208,192);Trees(160,208);Trees(192,208);Trees(224,208);Trees(160,240);SteelWall(128,240);SteelWall(144,240);SteelWall(128,256);SteelWall(144,256);SteelWall(128,272);SteelWall(144,272);SteelWall(128,288);SteelWall(144,288);BrickWall(128,304);BrickWall(144,304);BrickWall(128,320);BrickWall(144,320);BrickWall(128,336);BrickWall(144,336);BrickWall(128,352);BrickWall(144,352);BrickWall(128,400);BrickWall(144,400);BrickWall(128,416);BrickWall(144,416);BrickWall(192,336);BrickWall(208,336);BrickWall(192,352);BrickWall(208,352);BrickWall(224,336);BrickWall(240,336);BrickWall(224,352);BrickWall(240,352);BrickWall(256,336);BrickWall(272,336);BrickWall(256,352);BrickWall(272,352);BrickWall(256,304);BrickWall(272,304);BrickWall(256,320);BrickWall(272,320);BrickWall(224,304);BrickWall(240,304);BrickWall(224,320);BrickWall(240,320);BrickWall(192,304);BrickWall(208,304);BrickWall(192,320);BrickWall(208,320);BrickWall(192,272);BrickWall(208,272);BrickWall(192,288);BrickWall(208,288);BrickWall(192,240);BrickWall(208,240);BrickWall(192,256);BrickWall(208,256);BrickWall(256,240);BrickWall(272,240);BrickWall(256,256);BrickWall(272,256);BrickWall(256,272);BrickWall(272,272);BrickWall(256,288);BrickWall(272,288);SteelWall(256,208);SteelWall(272,208);SteelWall(256,224);SteelWall(272,224);SteelWall(288,176);SteelWall(304,176);SteelWall(288,192);SteelWall(304,192);SteelWall(224,144);SteelWall(240,144);SteelWall(224,160);SteelWall(240,160);SteelWall(256,16);SteelWall(272,16);SteelWall(256,32);SteelWall(272,32);BrickWall(256,48);BrickWall(272,48);BrickWall(256,64);BrickWall(272,64);BrickWall(256,80);BrickWall(272,80);BrickWall(256,96);BrickWall(272,96);BrickWall(224,80);BrickWall(240,80);BrickWall(224,96);BrickWall(240,96);BrickWall(320,80);BrickWall(336,80);BrickWall(320,96);BrickWall(336,96);BrickWall(320,48);BrickWall(336,48);BrickWall(320,64);BrickWall(336,64);SteelWall(352,80);SteelWall(368,80);SteelWall(352,96);SteelWall(368,96);SteelWall(320,112);SteelWall(336,112);SteelWall(320,128);SteelWall(336,128);SteelWall(416,144);SteelWall(432,144);SteelWall(416,160);SteelWall(432,160);BrickWall(384,80);BrickWall(400,80);BrickWall(384,96);BrickWall(400,96);BrickWall(384,48);BrickWall(400,48);BrickWall(384,64);BrickWall(400,64);BrickWall(320,144);BrickWall(336,144);BrickWall(320,160);BrickWall(336,160);BrickWall(384,144);BrickWall(400,144);BrickWall(384,160);BrickWall(400,160);BrickWall(384,208);BrickWall(400,208);BrickWall(384,224);BrickWall(400,224);BrickWall(384,240);BrickWall(400,240);BrickWall(384,256);BrickWall(400,256);BrickWall(384,272);BrickWall(400,272);BrickWall(384,288);BrickWall(400,288);BrickWall(384,304);BrickWall(400,304);BrickWall(384,320);BrickWall(400,320);BrickWall(320,304);BrickWall(336,304);BrickWall(320,320);BrickWall(336,320);BrickWall(320,240);BrickWall(336,240);BrickWall(320,256);BrickWall(336,256);BrickWall(320,368);BrickWall(336,368);BrickWall(320,384);BrickWall(336,384);BrickWall(320,400);BrickWall(336,400);BrickWall(320,416);BrickWall(336,416);BrickWall(352,400);BrickWall(368,400);BrickWall(352,416);BrickWall(368,416);BrickWall(384,400);BrickWall(400,400);BrickWall(384,416);BrickWall(400,416);BrickWall(384,368);BrickWall(400,368);BrickWall(384,384);BrickWall(400,384);SteelWall(352,304);SteelWall(368,304);SteelWall(352,320);SteelWall(368,320);Trees(352,208);Trees(352,176);Trees(352,144)",tanks:[Tank.Type.ARMOR,Tank.Type.ARMOR,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC]}),Globals.stages.push({map:"Base(224,400);BrickWall(208,416);BrickWall(208,400);BrickWall(208,384);BrickWall(224,384);BrickWall(240,384);BrickWall(256,384);BrickWall(256,400);BrickWall(256,416);BrickWall(32,80);BrickWall(48,80);BrickWall(32,96);BrickWall(48,96);Trees(64,48);Trees(64,80);Trees(96,80);Trees(96,48);Trees(128,48);Trees(128,80);Trees(128,112);Trees(96,112);Trees(64,112);Trees(32,112);Trees(32,144);Trees(64,144);Trees(96,144);Trees(128,144);Trees(128,176);Trees(96,176);Trees(64,176);Trees(32,176);Trees(64,208);BrickWall(64,256);BrickWall(80,256);BrickWall(64,272);BrickWall(64,288);BrickWall(32,272);BrickWall(48,272);BrickWall(32,288);BrickWall(48,288);BrickWall(112,272);BrickWall(112,288);BrickWall(128,256);BrickWall(144,256);BrickWall(160,272);BrickWall(160,288);BrickWall(128,272);BrickWall(144,272);BrickWall(128,288);BrickWall(144,288);BrickWall(32,336);BrickWall(48,336);BrickWall(32,352);BrickWall(48,352);BrickWall(32,368);BrickWall(48,368);BrickWall(32,384);BrickWall(48,384);BrickWall(64,368);BrickWall(80,368);BrickWall(64,384);BrickWall(80,384);BrickWall(64,400);BrickWall(80,400);BrickWall(64,416);BrickWall(80,416);BrickWall(96,400);BrickWall(112,400);BrickWall(96,416);BrickWall(112,416);SteelWall(32,400);SteelWall(48,400);SteelWall(32,416);SteelWall(48,416);SteelWall(128,368);SteelWall(128,384);SteelWall(128,336);SteelWall(128,352);BrickWall(208,272);BrickWall(208,288);BrickWall(224,272);BrickWall(240,272);BrickWall(256,272);BrickWall(272,272);BrickWall(288,272);BrickWall(304,272);BrickWall(192,304);BrickWall(208,304);BrickWall(192,320);BrickWall(208,320);BrickWall(256,320);BrickWall(272,320);BrickWall(288,320);BrickWall(304,320);BrickWall(256,336);BrickWall(272,336);BrickWall(288,336);BrickWall(304,336);BrickWall(320,400);BrickWall(336,400);BrickWall(320,416);BrickWall(336,416);Trees(320,368);Trees(352,368);Trees(384,368);Trees(384,336);Trees(352,336);Trees(320,336);Trees(320,304);Trees(352,304);Trees(384,304);Trees(416,304);Trees(416,272);Trees(384,272);Trees(352,272);Trees(320,272);Trees(320,240);Trees(352,240);Trees(416,240);Trees(384,240);Trees(384,208);SteelWall(288,208);SteelWall(304,208);SteelWall(288,224);SteelWall(304,224);SteelWall(256,208);SteelWall(272,208);SteelWall(256,224);SteelWall(272,224);SteelWall(224,208);SteelWall(240,208);SteelWall(224,224);SteelWall(240,224);BrickWall(224,176);BrickWall(240,176);BrickWall(224,192);BrickWall(240,192);BrickWall(224,144);BrickWall(240,144);BrickWall(224,160);BrickWall(240,160);BrickWall(192,144);BrickWall(208,144);BrickWall(192,160);BrickWall(208,160);BrickWall(160,144);BrickWall(176,144);BrickWall(160,160);BrickWall(176,160);BrickWall(256,112);BrickWall(272,112);BrickWall(256,128);BrickWall(272,128);BrickWall(256,144);BrickWall(272,144);BrickWall(320,144);BrickWall(336,144);BrickWall(320,160);BrickWall(336,160);BrickWall(320,112);BrickWall(336,112);BrickWall(320,128);BrickWall(336,128);BrickWall(352,112);BrickWall(368,112);BrickWall(352,128);BrickWall(368,128);BrickWall(384,112);BrickWall(400,112);BrickWall(384,128);BrickWall(400,128);BrickWall(416,112);BrickWall(416,128);BrickWall(400,144);BrickWall(400,160);BrickWall(400,176);BrickWall(400,192);BrickWall(288,16);BrickWall(304,16);BrickWall(288,32);BrickWall(304,32);BrickWall(160,16);BrickWall(176,16);BrickWall(160,32);BrickWall(176,32);BrickWall(160,48);BrickWall(176,48);BrickWall(160,64);BrickWall(176,64);SteelWall(416,64);SteelWall(432,64);SteelWall(384,64);SteelWall(400,64);SteelWall(352,64);SteelWall(368,64)",tanks:[Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.ARMOR,Tank.Type.ARMOR]}),Globals.stages.push({map:"Base(224,400);BrickWall(208,416);BrickWall(208,400);BrickWall(208,384);BrickWall(224,384);BrickWall(240,384);BrickWall(256,384);BrickWall(256,400);BrickWall(256,416);Trees(64,16);Trees(96,16);Trees(64,48);Trees(32,48);Trees(32,80);SteelWall(32,112);SteelWall(48,112);Water(32,176);SteelWall(32,400);SteelWall(48,400);SteelWall(32,416);SteelWall(48,416);Trees(64,400);Trees(32,368);BrickWall(64,336);BrickWall(80,336);BrickWall(64,352);BrickWall(80,352);BrickWall(96,336);BrickWall(112,336);BrickWall(96,352);BrickWall(112,352);BrickWall(96,368);BrickWall(112,368);BrickWall(128,368);BrickWall(144,368);BrickWall(128,352);BrickWall(144,352);BrickWall(64,304);BrickWall(80,304);BrickWall(96,304);BrickWall(112,304);BrickWall(160,336);BrickWall(176,336);BrickWall(256,336);BrickWall(272,336);BrickWall(192,336);BrickWall(208,336);BrickWall(192,352);BrickWall(208,352);BrickWall(224,336);BrickWall(240,336);BrickWall(224,352);BrickWall(240,352);BrickWall(128,304);BrickWall(144,304);BrickWall(128,320);BrickWall(144,320);BrickWall(160,304);BrickWall(176,304);BrickWall(160,320);BrickWall(176,320);BrickWall(192,304);BrickWall(208,304);BrickWall(192,320);BrickWall(208,320);BrickWall(224,304);BrickWall(240,304);BrickWall(224,320);BrickWall(240,320);BrickWall(256,304);BrickWall(272,304);BrickWall(256,320);BrickWall(272,320);BrickWall(288,304);BrickWall(304,304);BrickWall(288,320);BrickWall(304,320);BrickWall(80,272);BrickWall(80,288);BrickWall(96,240);BrickWall(112,240);BrickWall(96,256);BrickWall(112,256);BrickWall(96,208);BrickWall(112,208);BrickWall(96,224);BrickWall(112,224);BrickWall(112,176);BrickWall(112,192);BrickWall(112,144);BrickWall(112,160);BrickWall(128,144);BrickWall(144,144);BrickWall(128,112);BrickWall(144,112);BrickWall(128,128);BrickWall(144,128);BrickWall(160,112);BrickWall(176,112);BrickWall(160,128);BrickWall(176,128);BrickWall(192,112);BrickWall(208,112);BrickWall(192,128);BrickWall(208,128);BrickWall(224,112);BrickWall(240,112);BrickWall(224,128);BrickWall(240,128);BrickWall(256,112);BrickWall(272,112);BrickWall(256,128);BrickWall(272,128);BrickWall(288,112);BrickWall(304,112);BrickWall(288,128);BrickWall(304,128);BrickWall(320,112);BrickWall(336,112);BrickWall(320,128);BrickWall(336,128);BrickWall(352,112);BrickWall(368,112);BrickWall(352,128);BrickWall(368,128);BrickWall(384,112);BrickWall(384,128);BrickWall(384,144);BrickWall(384,160);BrickWall(320,176);BrickWall(320,192);BrickWall(320,208);BrickWall(320,224);BrickWall(352,272);BrickWall(352,288);BrickWall(352,304);BrickWall(368,304);BrickWall(320,304);BrickWall(336,304);BrickWall(320,336);BrickWall(336,336);BrickWall(320,352);BrickWall(336,352);BrickWall(352,336);BrickWall(368,336);BrickWall(352,352);BrickWall(368,352);BrickWall(320,368);BrickWall(336,368);BrickWall(288,368);BrickWall(304,368);BrickWall(288,352);BrickWall(304,352);BrickWall(320,272);BrickWall(336,272);BrickWall(320,288);BrickWall(336,288);BrickWall(288,272);BrickWall(304,272);BrickWall(288,288);BrickWall(304,288);BrickWall(256,272);BrickWall(272,272);BrickWall(256,288);BrickWall(272,288);BrickWall(224,272);BrickWall(240,272);BrickWall(224,288);BrickWall(240,288);BrickWall(192,272);BrickWall(208,272);BrickWall(192,288);BrickWall(208,288);BrickWall(160,272);BrickWall(176,272);BrickWall(160,288);BrickWall(176,288);BrickWall(128,272);BrickWall(144,272);BrickWall(128,288);BrickWall(144,288);BrickWall(96,272);BrickWall(112,272);BrickWall(96,288);BrickWall(112,288);BrickWall(128,240);BrickWall(144,240);BrickWall(128,256);BrickWall(144,256);BrickWall(160,240);BrickWall(176,240);BrickWall(160,256);BrickWall(176,256);BrickWall(192,240);BrickWall(208,240);BrickWall(192,256);BrickWall(208,256);BrickWall(224,240);BrickWall(240,240);BrickWall(224,256);BrickWall(240,256);BrickWall(256,240);BrickWall(272,240);BrickWall(256,256);BrickWall(272,256);BrickWall(288,240);BrickWall(304,240);BrickWall(288,256);BrickWall(304,256);BrickWall(320,240);BrickWall(336,240);BrickWall(320,256);BrickWall(336,256);BrickWall(288,208);BrickWall(304,208);BrickWall(288,224);BrickWall(304,224);BrickWall(288,176);BrickWall(304,176);BrickWall(288,192);BrickWall(304,192);BrickWall(288,144);BrickWall(304,144);BrickWall(288,160);BrickWall(304,160);BrickWall(320,144);BrickWall(336,144);BrickWall(320,160);BrickWall(336,160);BrickWall(256,144);BrickWall(272,144);BrickWall(160,224);BrickWall(176,224);BrickWall(192,224);BrickWall(208,224);SteelWall(160,176);SteelWall(160,192);SteelWall(224,176);SteelWall(224,192);BrickWall(144,80);BrickWall(144,96);BrickWall(160,64);BrickWall(176,64);BrickWall(256,64);BrickWall(272,64);BrickWall(288,64);BrickWall(304,64);BrickWall(352,96);BrickWall(368,96);BrickWall(320,80);BrickWall(336,80);BrickWall(320,96);BrickWall(336,96);BrickWall(288,80);BrickWall(304,80);BrickWall(288,96);BrickWall(304,96);BrickWall(256,80);BrickWall(272,80);BrickWall(256,96);BrickWall(272,96);BrickWall(224,80);BrickWall(240,80);BrickWall(224,96);BrickWall(240,96);BrickWall(192,80);BrickWall(208,80);BrickWall(192,96);BrickWall(208,96);BrickWall(160,80);BrickWall(176,80);BrickWall(160,96);BrickWall(176,96);BrickWall(192,48);BrickWall(208,48);BrickWall(192,64);BrickWall(208,64);BrickWall(224,48);BrickWall(240,48);BrickWall(224,64);BrickWall(240,64);SteelWall(416,80);SteelWall(432,80);SteelWall(416,400);SteelWall(432,400);SteelWall(416,416);SteelWall(432,416);Trees(416,368);Trees(384,368);Trees(352,400);Trees(384,400);Trees(416,336);Trees(416,48);Trees(384,16);Water(416,208);Water(384,208)",tanks:[Tank.Type.POWER,Tank.Type.POWER,Tank.Type.POWER,Tank.Type.POWER,Tank.Type.POWER,Tank.Type.POWER,Tank.Type.POWER,Tank.Type.POWER,Tank.Type.POWER,Tank.Type.POWER,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.FAST,Tank.Type.BASIC,Tank.Type.BASIC,Tank.Type.ARMOR,Tank.Type.ARMOR,Tank.Type.ARMOR]}),MoveFn.prototype.update=function(){this._active&&(this._object[this._property]+=this._increment,this._isCompleted()&&(this._active=!1,this._listener.actionCompleted()))},MoveFn.prototype._isCompleted=function(){return this._increment>0&&this._object[this._property]>=this._endValue||this._increment<0&&this._object[this._property]<=this._endValue},GameOverMessage.prototype.draw=function(t){t.fillStyle="#e44437",t.fillText("GAME",this.x,this.y),t.fillText("OVER",this.x,this.y+16)},StageStatisticsScene.prototype.update=function(){this._script.update()},StageStatisticsScene.prototype.draw=function(t){t.drawImage(backgroundImage,0,0,t.canvas.width,t.canvas.height),t.fillStyle="#feac4e",t.fillText("20000",306,46),t.fillStyle="#ffffff",t.fillText("STAGE "+(""+this._stage).lpad(" ",2),194,78),t.drawImage(ImageManager.getImage("roman_one_red"),52,96),t.fillStyle="#e44437",t.fillText("-PLAYER",66,110),t.fillStyle="#feac4e",t.fillText((""+this._player.getScore()).lpad(" ",7),66,142),t.fillStyle="#ffffff",t.fillText("PTS",130,190),this._basicTankPoints.draw(t,34,190),t.drawImage(ImageManager.getImage("tank_basic_up_c0_t1"),241,169),t.drawImage(ImageManager.getImage("arrow"),226,176),t.fillText("PTS",130,238),this._fastTankPoints.draw(t,34,238),t.drawImage(ImageManager.getImage("tank_fast_up_c0_t1"),241,217),t.drawImage(ImageManager.getImage("arrow"),226,224),t.fillText("PTS",130,286),this._powerTankPoints.draw(t,34,286),t.drawImage(ImageManager.getImage("tank_power_up_c0_t1"),241,265),t.drawImage(ImageManager.getImage("arrow"),226,272),t.fillText("PTS",130,334),this._armorTankPoints.draw(t,34,334),t.drawImage(ImageManager.getImage("tank_armor_up_c0_t1"),241,313),t.drawImage(ImageManager.getImage("arrow"),226,320),t.fillText("TOTAL",100,366),t.drawImage(ImageManager.getImage("white_line"),192,346),this._drawTotal&&t.fillText((""+this._player.getTanksCount()).lpad(" ",2),194,366)},GameOverScene.prototype.update=function(){this._script.update()},GameOverScene.prototype.draw=function(t){t.drawImage(backgroundImage,0,0,t.canvas.width,t.canvas.height),t.drawImage(ImageManager.getImage("game_over"),128,128)},Player.Event={},Player.Event.OUT_OF_LIVES="Player.Event.OUT_OF_LIVES",Player.prototype.resetTanks=function(){this._tanks={},this._tanks[Tank.Type.BASIC]=0,this._tanks[Tank.Type.FAST]=0,this._tanks[Tank.Type.POWER]=0,this._tanks[Tank.Type.ARMOR]=0,this._tanksCount=0},Player.prototype.setEventManager=function(t){this._eventManager=t,this._eventManager.addSubscriber(this,[PointsFactory.Event.POINTS_CREATED,Tank.Event.PLAYER_DESTROYED,PowerUpHandler.Event.TANK,Tank.Event.ENEMY_DESTROYED])},Player.prototype.notify=function(t){t.name==PointsFactory.Event.POINTS_CREATED?this._score+=t.points.getValue():t.name==Tank.Event.PLAYER_DESTROYED?0==this._lives?this._eventManager.fireEvent({name:Player.Event.OUT_OF_LIVES}):this._lives--:t.name==PowerUpHandler.Event.TANK?this._lives++:t.name==Tank.Event.ENEMY_DESTROYED&&t.tank.getValue()>0&&(this._tanks[t.tank.getType()]++,this._tanksCount++)},Player.prototype.getScore=function(){return this._score},Player.prototype.getLives=function(){return this._lives},Player.prototype.getTanks=function(t){return this._tanks[t]},Player.prototype.getTanksCount=function(){return this._tanksCount},StageStatisticsPoints.prototype.update=function(){this._script.update()},StageStatisticsPoints.prototype.draw=function(t,e,i){if(this._visible){t.fillStyle="#ffffff";var n=(""+this._counter*this._value).lpad(" ",5);n+="     ",n+=(""+this._counter).lpad(" ",2),t.fillText(n,e,i)}},StageStatisticsPoints.prototype.show=function(){this._visible=!0},Trees.subclass(Sprite),Trees.prototype.getClassName=function(){return"Trees"},Trees.prototype.draw=function(t){t.drawImage(ImageManager.getImage("trees"),this._x,this._y)},Water.subclass(Sprite),Water.prototype.getClassName=function(){return"Water"},Water.prototype.stopAnimation=function(){this._animation.setActive(!1)},Water.prototype.updateHook=function(){this._animation.update()},Water.prototype.getImage=function(){return"water_"+this._animation.getFrame()},Water.prototype.draw=function(t){t.drawImage(ImageManager.getImage(this.getImage()),this._x,this._y)},LoadingScene.prototype.update=function(){this._loadingProgress=ImageManager.getLoadingProgress(),100==this._loadingProgress&&this._sceneManager.toMainMenuScene(!1)},LoadingScene.prototype.draw=function(t){t.fillStyle="#14ff06",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.fillStyle="#ffffff",t.fillText("LOADING "+(""+this._loadingProgress).lpad(" ",3)+"%",160,240)};var Stats=function(){var t=Date.now(),e=t,i=0,n=1e3,r=0,a=0,l=1e3,o=0,s=0,c=0,p=document.createElement("div");p.id="stats",p.addEventListener("mousedown",(function(t){t.preventDefault(),S(++c%2)}),!1),p.style.cssText="width:80px;opacity:0.9;cursor:pointer";var _=document.createElement("div");_.id="fps",_.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",p.appendChild(_);var u=document.createElement("div");u.id="fpsText",u.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",u.innerHTML="FPS",_.appendChild(u);var h=document.createElement("div");for(h.id="fpsGraph",h.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",_.appendChild(h);h.children.length<74;){(B=document.createElement("span")).style.cssText="width:1px;height:30px;float:left;background-color:#113",h.appendChild(B)}var k=document.createElement("div");k.id="ms",k.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",p.appendChild(k);var y=document.createElement("div");y.id="msText",y.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",y.innerHTML="MS",k.appendChild(y);var T=document.createElement("div");for(T.id="msGraph",T.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",k.appendChild(T);T.children.length<74;){var B;(B=document.createElement("span")).style.cssText="width:1px;height:30px;float:left;background-color:#131",T.appendChild(B)}var S=function(t){switch(c=t){case 0:_.style.display="block",k.style.display="none";break;case 1:_.style.display="none",k.style.display="block"}},E=function(t,e){t.appendChild(t.firstChild).style.height=e+"px"};return{domElement:p,setMode:S,begin:function(){t=Date.now()},end:function(){var c=Date.now();return i=c-t,n=Math.min(n,i),r=Math.max(r,i),y.textContent=i+" MS ("+n+"-"+r+")",E(T,Math.min(30,30-i/200*30)),s++,c>e+1e3&&(a=Math.round(1e3*s/(c-e)),l=Math.min(l,a),o=Math.max(o,a),u.textContent=a+" FPS ("+l+"-"+o+")",E(h,Math.min(30,30-a/100*30)),e=c,s=0),c},update:function(){t=this.end()}}};function FPSCounter(){this._stats=new Stats,this._stats.setMode(0),this._stats.domElement.style.position="absolute",this._stats.domElement.style.right="0px",this._stats.domElement.style.top="0px",document.body.appendChild(this._stats.domElement)}FPSCounter.prototype.begin=function(){this._stats.begin()},FPSCounter.prototype.end=function(){this._stats.end()};var ImageManager=function(){var t={tank_player1_down_c0_t1:null,tank_player1_down_c0_t2:null,tank_player1_left_c0_t1:null,tank_player1_left_c0_t2:null,tank_player1_right_c0_t1:null,tank_player1_right_c0_t2:null,tank_player1_up_c0_t1:null,tank_player1_up_c0_t2:null,tank_player1_down_c0_t1_s1:null,tank_player1_down_c0_t2_s1:null,tank_player1_left_c0_t1_s1:null,tank_player1_left_c0_t2_s1:null,tank_player1_right_c0_t1_s1:null,tank_player1_right_c0_t2_s1:null,tank_player1_up_c0_t1_s1:null,tank_player1_up_c0_t2_s1:null,tank_player1_down_c0_t1_s2:null,tank_player1_down_c0_t2_s2:null,tank_player1_left_c0_t1_s2:null,tank_player1_left_c0_t2_s2:null,tank_player1_right_c0_t1_s2:null,tank_player1_right_c0_t2_s2:null,tank_player1_up_c0_t1_s2:null,tank_player1_up_c0_t2_s2:null,tank_player1_down_c0_t1_s3:null,tank_player1_down_c0_t2_s3:null,tank_player1_left_c0_t1_s3:null,tank_player1_left_c0_t2_s3:null,tank_player1_right_c0_t1_s3:null,tank_player1_right_c0_t2_s3:null,tank_player1_up_c0_t1_s3:null,tank_player1_up_c0_t2_s3:null,tank_basic_down_c0_t1:null,tank_basic_down_c0_t2:null,tank_basic_left_c0_t1:null,tank_basic_left_c0_t2:null,tank_basic_right_c0_t1:null,tank_basic_right_c0_t2:null,tank_basic_up_c0_t1:null,tank_basic_up_c0_t2:null,tank_basic_down_c0_t1_f:null,tank_basic_down_c0_t2_f:null,tank_basic_left_c0_t1_f:null,tank_basic_left_c0_t2_f:null,tank_basic_right_c0_t1_f:null,tank_basic_right_c0_t2_f:null,tank_basic_up_c0_t1_f:null,tank_basic_up_c0_t2_f:null,tank_fast_down_c0_t1:null,tank_fast_down_c0_t2:null,tank_fast_left_c0_t1:null,tank_fast_left_c0_t2:null,tank_fast_right_c0_t1:null,tank_fast_right_c0_t2:null,tank_fast_up_c0_t1:null,tank_fast_up_c0_t2:null,tank_fast_down_c0_t1_f:null,tank_fast_down_c0_t2_f:null,tank_fast_left_c0_t1_f:null,tank_fast_left_c0_t2_f:null,tank_fast_right_c0_t1_f:null,tank_fast_right_c0_t2_f:null,tank_fast_up_c0_t1_f:null,tank_fast_up_c0_t2_f:null,tank_power_down_c0_t1:null,tank_power_down_c0_t2:null,tank_power_left_c0_t1:null,tank_power_left_c0_t2:null,tank_power_right_c0_t1:null,tank_power_right_c0_t2:null,tank_power_up_c0_t1:null,tank_power_up_c0_t2:null,tank_power_down_c0_t1_f:null,tank_power_down_c0_t2_f:null,tank_power_left_c0_t1_f:null,tank_power_left_c0_t2_f:null,tank_power_right_c0_t1_f:null,tank_power_right_c0_t2_f:null,tank_power_up_c0_t1_f:null,tank_power_up_c0_t2_f:null,tank_armor_down_c0_t1:null,tank_armor_down_c0_t1_f:null,tank_armor_down_c0_t2:null,tank_armor_down_c0_t2_f:null,tank_armor_down_c1_t1:null,tank_armor_down_c1_t2:null,tank_armor_down_c2_t1:null,tank_armor_down_c2_t2:null,tank_armor_left_c0_t1:null,tank_armor_left_c0_t1_f:null,tank_armor_left_c0_t2:null,tank_armor_left_c0_t2_f:null,tank_armor_left_c1_t1:null,tank_armor_left_c1_t2:null,tank_armor_left_c2_t1:null,tank_armor_left_c2_t2:null,tank_armor_right_c0_t1:null,tank_armor_right_c0_t1_f:null,tank_armor_right_c0_t2:null,tank_armor_right_c0_t2_f:null,tank_armor_right_c1_t1:null,tank_armor_right_c1_t2:null,tank_armor_right_c2_t1:null,tank_armor_right_c2_t2:null,tank_armor_up_c0_t1:null,tank_armor_up_c0_t1_f:null,tank_armor_up_c0_t2:null,tank_armor_up_c0_t2_f:null,tank_armor_up_c1_t1:null,tank_armor_up_c1_t2:null,tank_armor_up_c2_t1:null,tank_armor_up_c2_t2:null,appear_1:null,appear_2:null,appear_3:null,appear_4:null,big_explosion_1:null,big_explosion_2:null,big_explosion_3:null,big_explosion_4:null,big_explosion_5:null,shield_1:null,shield_2:null,bullet_up:null,bullet_down:null,bullet_left:null,bullet_right:null,bullet_explosion_1:null,bullet_explosion_2:null,bullet_explosion_3:null,wall_brick:null,wall_steel:null,trees:null,water_1:null,water_2:null,base:null,base_destroyed:null,enemy:null,lives:null,roman_one:null,roman_one_white:null,roman_one_red:null,points_100:null,points_200:null,points_300:null,points_400:null,points_500:null,powerup_grenade:null,powerup_helmet:null,powerup_shovel:null,powerup_star:null,powerup_tank:null,powerup_timer:null,battle_city:null,namcot:null,copyright:null,white_line:null,arrow:null,game_over:null},e=Object.size(t),i=0;for(var n in t){var r=new Image;r.src="images/"+n+".png",r.onload=function(){++i},t[n]=r}return{getImage:function(e){return t[e]},getLoadingProgress:function(){return Math.floor(i/e*100)}}}();function SpriteSerializerController(t,e){this._eventManager=t,this._eventManager.addSubscriber(this,[Keyboard.Event.KEY_RELEASED]),this._structureManager=e,this._spriteSerializer=new SpriteSerializer(this._eventManager),this._createTextArea()}function SpriteSerializer(t){this._eventManager=t}SpriteSerializerController.prototype._createTextArea=function(){this._textarea=$("<textarea />"),this._textarea.css("width",Globals.CANVAS_WIDTH-6),this._div=$('<div id="serialize" />'),this._div.append(this._textarea),$("#main").prepend(this._div)},SpriteSerializerController.prototype.destroy=function(){$("#serialize").remove()},SpriteSerializerController.prototype.notify=function(t){t.name==Keyboard.Event.KEY_RELEASED&&this.keyReleased(t.key)},SpriteSerializerController.prototype.keyReleased=function(t){t==Keyboard.Key.S&&this._output()},SpriteSerializerController.prototype._output=function(){var t=this._structureManager.getSprites(),e=this._spriteSerializer.serializeSprites(t);this._textarea.text(e)},SpriteSerializer.SEPARATOR=";",SpriteSerializer.prototype.serializeSprite=function(t){return t.getClassName()+"("+t.getX()+","+t.getY()+")"},SpriteSerializer.prototype.serializeSprites=function(t){var e=[];return t.forEach((function(t){e.push(this.serializeSprite(t))}),this),e.join(SpriteSerializer.SEPARATOR)},SpriteSerializer.prototype.unserializeSprites=function(t){var e=[];return t.split(SpriteSerializer.SEPARATOR).forEach((function(t){var i=t.match(/(\w+)\((\d+),(\d+)\)/),n=i[1],r=parseInt(i[2]),a=parseInt(i[3]),l=new window[n](this._eventManager);l.setPosition(new Point(r,a)),e.push(l)}),this),e};var SoundManager=function(){var t={stage_start:null,game_over:null,bullet_shot:null,bullet_hit_1:null,bullet_hit_2:null,explosion_1:null,explosion_2:null,pause:null,powerup_appear:null,powerup_pick:null,statistics_1:null,enemy_explosion:null};for(var e in t){var i=new Audio("sound/"+e+".ogg");t[e]=i}return{play:function(e){t[e].play()}}}();
